<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSONæ•°ç»„å±•ç¤ºå·¥å…· - åœ¨çº¿JSONæ•°æ®è¡¨æ ¼å±•ç¤ºã€åˆ—ç®¡ç†ã€å¯¼å‡º</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="å…è´¹åœ¨çº¿JSONæ•°ç»„å±•ç¤ºå·¥å…·ï¼Œæ”¯æŒJSONæ•°æ®è§£æã€è¡¨æ ¼å±•ç¤ºã€åˆ—ç®¡ç†ã€æ•°æ®æœç´¢ã€æ’åºå’Œå¯¼å‡ºåŠŸèƒ½ã€‚å¯è§†åŒ–å±•ç¤ºJSONæ•°ç»„æ•°æ®ï¼Œæ“ä½œç®€å•é«˜æ•ˆã€‚">
    <meta name="keywords" content="JSONå·¥å…·,JSONæ•°ç»„,JSONè¡¨æ ¼,JSONå±•ç¤º,JSONè§£æ,JSONå¯¼å‡º,æ•°æ®å¯è§†åŒ–">
    <meta name="author" content="å¤šåŠŸèƒ½å·¥å…·ç®±">
    <meta name="robots" content="index, follow">
    <meta name="language" content="zh-CN">
    <!-- Canonical URL -->
    <link rel="canonical" href="https://www.seekpie.com/tools/json-array-tool.html">
    
    <!-- Structured Data (JSON-LD) -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "JSONæ•°ç»„å±•ç¤ºå·¥å…·",
      "description": "å…è´¹åœ¨çº¿JSONæ•°ç»„å±•ç¤ºå·¥å…·ï¼Œæ”¯æŒæ•°æ®è§£æã€è¡¨æ ¼å±•ç¤ºã€åˆ—ç®¡ç†å’Œå¯¼å‡º",
      "url": "https://www.seekpie.com/tools/json-array-tool.html",
      "applicationCategory": "DeveloperApplication",
      "operatingSystem": "All",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "CNY"
      },
      "featureList": [
        "JSONæ•°ç»„è§£æ",
        "è¡¨æ ¼å±•ç¤º",
        "åˆ—ç®¡ç†",
        "æ•°æ®æœç´¢",
        "æ’åºåŠŸèƒ½",
        "æ•°æ®å¯¼å‡º"
      ]
    }
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: clamp(10px, 2vw, 20px);
            font-size: clamp(14px, 1.5vw, 16px);
        }

        .container {
            max-width: min(1400px, 70vw);
            margin: 0 auto;
            background: white;
            border-radius: clamp(12px, 2vw, 15px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: clamp(20px, 4vw, 30px);
            text-align: center;
        }

        .header h1 {
            font-size: clamp(1.5em, 3.5vw, 2.5em);
            margin-bottom: clamp(8px, 1.5vw, 10px);
            font-weight: 300;
        }

        .header p {
            font-size: clamp(0.9em, 2vw, 1.1em);
            opacity: 0.9;
        }

        .main-content {
            padding: clamp(20px, 3vw, 30px);
        }

        .input-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 30px;
            border: 2px solid #e9ecef;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #495057;
        }

        .input-group textarea {
            width: 100%;
            min-height: 200px;
            padding: 15px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            resize: vertical;
            transition: border-color 0.3s ease;
        }

        .input-group textarea:focus {
            outline: none;
            border-color: #4facfe;
            box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.1);
        }

        .button-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        /* è§£æå¹¶å±•ç¤ºæŒ‰é’® */
        .btn-parse {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-parse:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
            background: linear-gradient(135deg, #5a6fd8 0%, #6a4190 100%);
        }

        /* æ ¼å¼åŒ–æŒ‰é’® */
        .btn-secondary {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }

        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(240, 147, 251, 0.4);
            background: linear-gradient(135deg, #e881e9 0%, #e3455a 100%);
        }

        /* å¯¼å‡ºCSVæŒ‰é’® */
        .btn-export {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            color: white;
        }

        .btn-export:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(67, 233, 123, 0.4);
            background: linear-gradient(135deg, #31d769 0%, #26e7c5 100%);
        }
        
        /* å†å²è®°å½•æŒ‰é’® */
        .btn-history {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            color: white;
        }
        
        .btn-history:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(250, 112, 154, 0.4);
            background: linear-gradient(135deg, #e85e88 0%, #ecd02e 100%);
        }

        /* æ¸…ç©ºå†å²è®°å½•æŒ‰é’® */
        .btn-clear-history {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            color: white;
        }
        
        .btn-clear-history:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 107, 107, 0.4);
            background: linear-gradient(135deg, #ee5a5a 0%, #dc495d 100%);
        }

        /* å…³é—­æŒ‰é’® */
        .btn-close {
            background: linear-gradient(135deg, #868f96 0%, #596164 100%);
            color: white;
        }
        
        .btn-close:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(134, 143, 150, 0.4);
            background: linear-gradient(135deg, #757d84 0%, #485052 100%);
        }

        /* åˆ—æ’åºæŒ‰é’® */
        .btn-sort-column {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }
        
        .btn-sort-column:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(79, 172, 254, 0.4);
            background: linear-gradient(135deg, #3d9aed 0%, #00e0ed 100%);
        }

        /* æ¸…é™¤æ’åºæŒ‰é’® */
        .btn-clear-sort {
            background: linear-gradient(135deg, #ffa751 0%, #ffe259 100%);
            color: white;
        }
        
        .btn-clear-sort:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 167, 81, 0.4);
            background: linear-gradient(135deg, #ee9540 0%, #eed048 100%);
        }

        /* åˆ‡æ¢åˆ—ç®¡ç†æŒ‰é’® */
        .btn-toggle-columns {
            background: linear-gradient(135deg, #4fd6cf 0%, #d8567f 100%);
            color: #ffffff;
        }
        
        .btn-toggle-columns:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(168, 237, 234, 0.4);
            background: linear-gradient(135deg, #74dfd9 0%, #a5506b 100%);
        }

        .controls-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 30px;
            border: 2px solid #e9ecef;
        }

        .controls-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            align-items: center;
        }

        .search-box {
            flex: 1;
            min-width: 250px;
            position: relative;
        }

        .search-box input {
            width: 100%;
            padding: 12px 40px 12px 15px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .search-box input:focus {
            outline: none;
            border-color: #4facfe;
            box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.1);
        }

        .search-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #6c757d;
        }

        .pagination-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .pagination-controls select {
            padding: 8px 12px;
            border: 2px solid #dee2e6;
            border-radius: 6px;
            font-size: 14px;
        }

        .column-controls {
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .column-select-all {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        .column-select-all label {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            padding: 8px 12px;
            background: white;
            border: 2px solid #dee2e6;
            border-radius: 6px;
            transition: all 0.3s ease;
        }

        .column-select-all label:hover {
            border-color: #4facfe;
            background: #f8f9ff;
        }

        .column-select-all input[type="checkbox"] {
            cursor: pointer;
            width: 18px;
            height: 18px;
            accent-color: #4facfe;
        }

        .column-select-all span {
            font-weight: 500;
            color: #495057;
            user-select: none;
        }

        #sortColumnsBtn {
            padding: 8px 16px;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        #sortColumnsIcon {
            font-size: 1.1em;
        }

        .history-panel {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 30px;
            border: 2px solid #e9ecef;
        }

        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #dee2e6;
        }

        .history-header h3 {
            margin: 0;
            color: #495057;
            font-size: 1.4em;
        }

        .history-controls {
            display: flex;
            gap: 10px;
        }

        .history-list {
            max-height: 600px;
            overflow-y: auto;
        }

        .history-item {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .history-item:hover {
            border-color: #4facfe;
            box-shadow: 0 2px 8px rgba(79, 172, 254, 0.1);
            transform: translateY(-1px);
        }

        .history-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .history-item-title {
            font-weight: 600;
            color: #495057;
            font-size: 1.1em;
        }

        .history-item-time {
            color: #6c757d;
            font-size: 0.9em;
        }

        .history-item-preview {
            color: #6c757d;
            font-size: 0.9em;
            margin-bottom: 10px;
            max-height: 60px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: pre-wrap;
            word-break: break-word;
            line-height: 1.4;
        }

        .history-item-details {
            background: #f8f9fa;
            border-radius: 6px;
            padding: 10px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.85em;
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #e9ecef;
            display: none;
            white-space: pre-wrap;
            line-height: 1.6;
        }

        .history-item-details.expanded {
            display: block;
        }

        .history-item-stats {
            display: flex;
            gap: 15px;
            margin-bottom: 10px;
            font-size: 0.85em;
            color: #495057;
        }

        .history-item-stat {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .history-item-stat span {
            font-weight: 600;
            color: #4facfe;
        }

        .history-item-actions {
            display: flex;
            gap: 8px;
        }

        .history-item-actions button {
            padding: 4px 8px;
            font-size: 0.8em;
            border: 1px solid #dee2e6;
            background: white;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .history-item-actions button:hover {
            background: #f8f9fa;
            border-color: #4facfe;
        }

        .history-item-actions .delete-btn:hover {
            background: #f8d7da;
            border-color: #dc3545;
            color: #dc3545;
        }

        .toggle-details-btn {
            background: #4facfe;
            color: rgb(0, 0, 0);
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8em;
            transition: all 0.3s ease;
        }

        .toggle-details-btn:hover {
            background: #3d8bfe;
        }

        .empty-history {
            text-align: center;
            color: #6c757d;
            padding: 40px;
            font-style: italic;
        }

        .column-toggle {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            background: white;
            border: 2px solid #dee2e6;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 201px;
        }

        .column-toggle:hover {
            border-color: #4facfe;
        }

        .column-toggle.active {
            background: #4facfe;
            color: white;
            border-color: #4facfe;
        }
        
        /* åˆ—è¿‡æ»¤è®¾ç½®æ ·å¼ */
        .column-filter-options {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
            margin-bottom: 10px;
        }
        
        .column-filter-option {
            display: flex;
            align-items: center;
            gap: 5px;
            margin: 0;
            cursor: pointer;
            padding: 6px 12px;
            border-radius: 6px;
            transition: all 0.3s ease;
        }
        
        .column-filter-option:hover {
            background: #f0f8ff;
        }
        
        .column-filter-option input[type="radio"] {
            cursor: pointer;
            width: 18px;
            height: 18px;
            accent-color: #4facfe;
        }
        
        .column-filter-option span {
            font-weight: 500;
            color: #495057;
            user-select: none;
        }
        
        #columnFilterInput:focus {
            outline: none;
            border-color: #4facfe;
            box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.1);
        }
        
        #columnFilterInput:disabled {
            background-color: #e9ecef;
            cursor: not-allowed;
        }
        
        /* æ ‡ç­¾è¾“å…¥å®¹å™¨ */
        .tags-input-container {
            width: 100%;
            min-height: 44px;
            padding: 6px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            background: white;
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            align-items: center;
            cursor: text;
            transition: border-color 0.3s ease;
        }
        
        .tags-input-container:focus-within {
            border-color: #4facfe;
            box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.1);
        }
        
        .tags-input-container.disabled {
            background-color: #e9ecef;
            cursor: not-allowed;
        }
        
        /* æ ‡ç­¾æ ·å¼ */
        .column-tag {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 10px;
            background: linear-gradient(135deg, #17a2b8 0%, #5ce1e6 100%);
            color: white;
            border-radius: 16px;
            font-size: 0.9em;
            font-weight: 500;
            animation: tagFadeIn 0.2s ease;
        }
        
        @keyframes tagFadeIn {
            from {
                opacity: 0;
                transform: scale(0.8);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
        
        .column-tag-text {
            user-select: none;
            max-width: 150px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .column-tag-remove {
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transition: all 0.2s ease;
            font-size: 14px;
            line-height: 1;
        }
        
        .column-tag-remove:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }
        
        /* æ ‡ç­¾è¾“å…¥æ¡† */
        .tags-input-field {
            flex: 1;
            min-width: 120px;
            border: none;
            outline: none;
            padding: 4px;
            font-size: 14px;
        }
        
        .tags-input-field:disabled {
            background: transparent;
            cursor: not-allowed;
        }
        
        /* æ ‡ç­¾å ä½ç¬¦ */
        .tags-placeholder {
            color: #6c757d;
            font-size: 14px;
            pointer-events: none;
            user-select: none;
        }
        
        /* å†…å®¹è¿‡æ»¤å™¨æ ‡ç­¾ */
        .filter-tag {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 6px 12px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 500;
            animation: tagFadeIn 0.2s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .filter-tag-content {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }
        
        .filter-tag-column {
            font-weight: 600;
            font-size: 0.95em;
        }
        
        .filter-tag-condition {
            font-size: 0.85em;
            opacity: 0.9;
        }
        
        .filter-tag-remove {
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transition: all 0.2s ease;
            font-size: 16px;
            line-height: 1;
            flex-shrink: 0;
        }
        
        .filter-tag-remove:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }
        
        /* åˆ—å†…å®¹è¿‡æ»¤åŒºåŸŸæ ·å¼ */
        .content-filter-section {
            background: #fff9e6;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #ffe4a3;
            margin-bottom: 15px;
        }
        
        .content-filter-header {
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
            width: 100%;
        }
        
        .content-filter-title {
            color: #495057;
        }
        
        .content-filter-subtitle {
            font-size: 0.85em;
            color: #6c757d;
            margin-left: 10px;
        }
        
        .filter-logic-selector {
            display: flex;
            align-items: center;
            gap: 10px;
            background: white;
            padding: 5px 12px;
            border-radius: 20px;
            border: 2px solid #ffe4a3;
        }
        
        .filter-logic-label {
            font-size: 0.85em;
            color: #495057;
            font-weight: 500;
        }
        
        .filter-logic-option {
            display: flex;
            align-items: center;
            gap: 5px;
            cursor: pointer;
            margin: 0;
        }
        
        .filter-logic-radio {
            cursor: pointer;
            accent-color: #f5576c;
        }
        
        .filter-logic-text {
            font-size: 0.9em;
            color: #495057;
            font-weight: 500;
        }
        
        .clear-all-filters-btn {
            padding: 6px 14px;
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            color: white;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.85em;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .clear-all-filters-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }
        
        .filter-input-row {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            align-items: center;
            padding: 10px;
            background: white;
            border-radius: 6px;
            border: 2px dashed #dee2e6;
            transition: all 0.3s ease;
        }
        
        .filter-input-row:hover {
            border-color: #4facfe;
        }
        
        .filter-input-field {
            flex: 1;
            min-width: 150px;
        }
        
        .filter-condition-field {
            min-width: 130px;
        }
        
        .filter-input {
            width: 100%;
            padding: 8px;
            border: 2px solid #dee2e6;
            border-radius: 6px;
            font-size: 14px;
        }
        
        .filter-input:focus {
            outline: none;
            border-color: #4facfe;
            box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.1);
        }
        
        .filter-select {
            width: 100%;
            padding: 8px;
            border: 2px solid #dee2e6;
            border-radius: 6px;
            font-size: 14px;
        }
        
        .filter-add-btn {
            padding: 8px 16px;
            white-space: nowrap;
        }
        
        /* åŠ¨æ€è¿‡æ»¤å™¨è¡Œæ ·å¼ */
        .filter-row {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            align-items: center;
            /* margin-bottom: 8px; */
            padding: 10px;
            background: white;
            border-radius: 6px;
            border: 2px solid #dee2e6;
            transition: all 0.3s ease;
        }
        
        .filter-row:hover {
            border-color: #4facfe;
        }
        
        .filter-row-field {
            flex: 1;
            min-width: 150px;
        }
        
        .filter-row-condition {
            min-width: 130px;
        }
        
        .filter-row-input {
            width: 100%;
            padding: 8px;
            border: 2px solid #dee2e6;
            border-radius: 6px;
            font-size: 14px;
        }
        
        .filter-row-input:disabled {
            background: #e9ecef;
        }
        
        .filter-row-select {
            width: 100%;
            padding: 8px;
            border: 2px solid #dee2e6;
            border-radius: 6px;
            font-size: 14px;
        }
        
        .filter-row-delete-btn {
            padding: 8px 16px;
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            white-space: nowrap;
        }
        
        .filter-row-delete-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .column-toggle > span:not(.drag-handle) {
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            max-width: 140px;
            display: inline-block;
            vertical-align: middle;
        }

        .table-container {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .table-search-controls {
            display: flex;
            gap: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-bottom: 2px solid #e9ecef;
            flex-wrap: wrap;
            align-items: center;
        }

        .table-wrapper {
            overflow-x: auto;
            max-height: 600px;
            overflow-y: auto;
            position: relative;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            /* font-size: 14px; */
            position: relative;
        }

        thead {
            position: sticky;
            top: 0;
            z-index: 10;
        }

        th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 12px;
            text-align: left;
            font-weight: 600;
            cursor: pointer;
            user-select: none;
            transition: background-color 0.3s ease;
            white-space: nowrap;
        }

        th:hover {
            background: linear-gradient(135deg, #5a6fd8 0%, #6a4190 100%);
        }

        th.sortable {
            position: relative;
            padding-right: 28px;
        }

        th.sortable::after {
            content: 'â†•';
            position: absolute;
            right: 8px;
            opacity: 0.3;
            font-size: 0.9em;
        }

        th.sortable:hover::after {
            opacity: 0.6;
        }

        th.sort-asc::after {
            content: 'â†‘';
            opacity: 1;
            color: #ffd700;
            font-weight: bold;
        }

        th.sort-desc::after {
            content: 'â†“';
            opacity: 1;
            color: #ffd700;
            font-weight: bold;
        }

        td {
            padding: 12px;
            border-bottom: 1px solid #e9ecef;
            vertical-align: top;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            min-width: 100px;
            max-width: 300px;
            position: relative;
            transition: background-color 0.2s ease;
        }

        tr:hover td {
            background-color: #f8f9fa;
        }

        td:hover {
            z-index: 5;
        }

        td:hover::after {
            content: attr(data-tooltip);
            position: absolute;
            top: 100%;
            left: 0;
            background: #333;
            color: white;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 0.9em;
            white-space: normal;
            max-width: 300px;
            word-wrap: break-word;
            z-index: 10;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            pointer-events: none;
        }

        td.expanded {
            white-space: normal;
            overflow: visible;
        }

        td.expanded:hover::after {
            display: none;
        }

        tr:nth-child(even) {
            background-color: #fdfdfd;
        }

        tr:nth-child(even):hover {
            background-color: #f8f9fa;
        }

        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin: 20px 0;
        }

        .pagination button {
            padding: 8px 12px;
            border: 2px solid #dee2e6;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .pagination button:hover:not(:disabled) {
            border-color: #4facfe;
            background: #4facfe;
            color: white;
        }

        .pagination button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .pagination .current-page {
            background: #4facfe;
            color: white;
            border-color: #4facfe;
        }

        .stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: #f8f9fa;
            border-top: 1px solid #e9ecef;
            font-size: 14px;
            color: #6c757d;
        }

        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            border: 1px solid #f5c6cb;
        }

        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            border: 1px solid #c3e6cb;
        }

        .json-preview {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }

        .drag-handle {
            cursor: move;
            color: #6c757d;
            margin-right: 8px;
        }

        .dragging {
            opacity: 0.5;
        }

        /* å¹³æ¿å’Œä¸­ç­‰å±å¹• */
        @media (max-width: 1024px) {
            .main-content {
                padding: 25px;
            }

            .input-section, .controls-section, .history-panel {
                padding: 20px;
            }
        }

        /* ç§»åŠ¨ç«¯ä¼˜åŒ– */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            .container {
                max-width: 100%;
                border-radius: 12px;
            }

            .header {
                padding: 20px 15px;
            }

            .header h1 {
                font-size: 1.8em;
                margin-bottom: 8px;
            }

            .header p {
                font-size: 0.95em;
            }

            .header p:last-child {
                font-size: 0.85em;
            }

            .main-content {
                padding: 20px 15px;
            }

            .input-section {
                padding: 20px 15px;
                margin-bottom: 20px;
            }

            .input-group label {
                font-size: 0.95em;
            }

            .input-group textarea {
                min-height: 150px;
                padding: 12px;
                font-size: 13px;
            }

            .button-group {
                justify-content: center;
                gap: 10px;
            }

            .btn {
                padding: 10px 18px;
                font-size: 14px;
                flex: 1;
                min-width: 120px;
                justify-content: center;
            }

            .controls-section {
                padding: 20px 15px;
                margin-bottom: 20px;
            }

            .controls-row {
                flex-direction: column;
                align-items: stretch;
                gap: 15px;
            }

            .table-search-controls {
                flex-direction: column;
                align-items: stretch;
                gap: 12px;
            }

            .search-box {
                min-width: auto;
                width: 100%;
            }

            .search-box input {
                padding: 10px 40px 10px 12px;
                font-size: 14px;
            }

            .pagination-controls {
                justify-content: center;
                flex-wrap: wrap;
            }

            .pagination-controls select {
                padding: 8px 10px;
                font-size: 13px;
            }

            .column-controls {
                justify-content: center;
            }

            .column-select-all {
                justify-content: center;
            }

            .column-select-all label {
                font-size: 0.9em;
                padding: 6px 10px;
            }

            #sortColumnsBtn {
                padding: 8px 14px;
                font-size: 14px;
            }

            .history-panel {
                padding: 20px 15px;
                margin-bottom: 20px;
            }

            .history-header {
                flex-direction: column;
                align-items: stretch;
                gap: 12px;
            }

            .history-header h3 {
                font-size: 1.2em;
                text-align: center;
            }

            .history-controls {
                justify-content: center;
                flex-wrap: wrap;
            }

            .history-list {
                max-height: 400px;
            }

            .history-item {
                padding: 12px;
            }

            .history-item-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 6px;
            }

            .history-item-title {
                font-size: 1em;
            }

            .history-item-time {
                font-size: 0.85em;
            }

            .history-item-stats {
                flex-wrap: wrap;
                gap: 10px;
            }

            .history-item-actions {
                flex-wrap: wrap;
            }

            .history-item-details {
                font-size: 0.8em;
                max-height: 250px;
            }

            .stats {
                flex-direction: column;
                gap: 10px;
                text-align: center;
            }

            .stats-item {
                font-size: 0.9em;
            }

            .data-table-container {
                border-radius: 8px;
            }

            .data-table th {
                padding: 10px 8px;
                font-size: 0.9em;
            }

            .data-table td {
                padding: 8px 6px;
                font-size: 0.9em;
                max-width: 150px;
            }

            .pagination {
                flex-wrap: wrap;
                gap: 8px;
                margin-top: 20px;
            }

            .pagination button {
                padding: 8px 12px;
                font-size: 0.85em;
            }

            .column-toggle {
                padding: 6px 10px;
                font-size: 0.85em;
            }
            
            .column-filter-options {
                gap: 10px;
            }
            
            .column-filter-option {
                padding: 5px 10px;
                font-size: 0.9em;
            }
            
            .column-filter-option input[type="radio"] {
                width: 16px;
                height: 16px;
            }
            
            /* ç§»åŠ¨ç«¯ä¼˜åŒ–åˆ—è¿‡æ»¤è®¾ç½®æ  */
            .input-group > div:first-child {
                flex-direction: column;
                align-items: flex-start !important;
                gap: 8px;
            }
            
            /* åˆ—å†…å®¹è¿‡æ»¤åŒºåŸŸ */
            .content-filter-header {
                flex-direction: column;
                align-items: flex-start !important;
                gap: 12px;
            }
            
            .filter-logic-selector {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .filter-logic-option {
                width: 100%;
                justify-content: flex-start;
            }
            
            .clear-all-filters-btn {
                width: 100%;
                justify-content: center;
                padding: 10px;
            }
            
            .filter-input-row {
                flex-direction: column !important;
                gap: 10px;
                padding: 12px;
            }
            
            .filter-input-field,
            .filter-condition-field {
                width: 100% !important;
                min-width: auto !important;
            }
            
            .filter-input,
            .filter-select {
                width: 100%;
                font-size: 14px;
            }
            
            .filter-add-btn {
                width: 100%;
                padding: 12px;
                font-size: 14px;
            }
            
            .filter-row {
                flex-direction: column !important;
                gap: 10px;
                padding: 12px;
            }
            
            .filter-row-field,
            .filter-row-condition {
                width: 100% !important;
            }
            
            .filter-row-input,
            .filter-row-select {
                width: 100%;
                font-size: 14px;
            }
            
            .filter-row-delete-btn {
                width: 100%;
                padding: 10px;
                font-size: 14px;
            }
            
            /* è¡¨æ ¼ä¼˜åŒ– */
            .table-wrapper {
                max-height: 500px;
            }
            
            th {
                position: sticky;
                white-space: normal;
                word-wrap: break-word;
                min-width: 80px;
            }
            
            td {
                white-space: normal;
                word-wrap: break-word;
            }
            
            /* æ¶ˆæ¯æç¤ºä¼˜åŒ– */
            .error-message,
            .success-message {
                padding: 12px;
                font-size: 14px;
                margin: 15px 0;
            }
        }

        /* å°å±æ‰‹æœºä¼˜åŒ– */
        @media (max-width: 480px) {
            body {
                padding: 8px;
            }

            .container {
                border-radius: 10px;
            }

            .header {
                padding: 15px 12px;
            }

            .header h1 {
                font-size: 1.5em;
            }

            .header p {
                font-size: 0.9em;
            }

            .header p:last-child {
                font-size: 0.8em;
            }

            .main-content {
                padding: 15px 12px;
            }

            .input-section {
                padding: 15px 12px;
            }

            .input-group textarea {
                min-height: 120px;
                padding: 10px;
                font-size: 12px;
            }

            .button-group {
                gap: 8px;
            }

            .btn {
                padding: 8px 14px;
                font-size: 13px;
                min-width: 100px;
            }

            .controls-section {
                padding: 15px 12px;
            }

            .controls-row {
                gap: 12px;
            }

            .search-box input {
                padding: 8px 35px 8px 10px;
                font-size: 13px;
            }

            .pagination-controls select {
                padding: 6px 8px;
                font-size: 12px;
            }

            .column-select-all label {
                font-size: 0.85em;
                padding: 5px 8px;
            }

            .column-select-all input[type="checkbox"] {
                width: 16px;
                height: 16px;
            }

            #sortColumnsBtn {
                padding: 6px 12px;
                font-size: 13px;
            }

            .history-panel {
                padding: 15px 12px;
            }

            .history-header h3 {
                font-size: 1.1em;
            }

            .history-item {
                padding: 10px;
            }

            .history-item-title {
                font-size: 0.95em;
            }

            .history-item-time {
                font-size: 0.8em;
            }

            .history-item-preview {
                font-size: 0.85em;
                max-height: 50px;
            }

            .history-item-stats {
                font-size: 0.8em;
                gap: 8px;
            }

            .history-item-actions button {
                padding: 3px 6px;
                font-size: 0.75em;
            }

            .history-item-details {
                font-size: 0.75em;
                max-height: 200px;
            }

            .stats-item {
                font-size: 0.85em;
            }

            .data-table th {
                padding: 8px 6px;
                font-size: 0.85em;
            }

            .data-table td {
                padding: 6px 4px;
                font-size: 0.85em;
                max-width: 120px;
            }

            .pagination button {
                padding: 6px 10px;
                font-size: 0.8em;
            }

            .column-toggle {
                padding: 5px 8px;
                font-size: 0.8em;
            }

            .toggle-details-btn {
                padding: 3px 6px;
                font-size: 0.75em;
            }
            
            .column-filter-options {
                gap: 8px;
                flex-direction: column;
                align-items: flex-start;
            }
            
            .column-filter-option {
                padding: 4px 8px;
                font-size: 0.85em;
                width: 100%;
            }
            
            .column-filter-option input[type="radio"] {
                width: 14px;
                height: 14px;
            }
            
            /* æ ‡ç­¾æ ·å¼è°ƒæ•´ */
            .column-tag {
                font-size: 0.85em;
                padding: 3px 8px;
            }
            
            .column-tag-text {
                max-width: 100px;
            }
            
            .column-tag-remove {
                width: 16px;
                height: 16px;
                font-size: 12px;
            }
            
            .tags-input-container {
                min-height: 38px;
                padding: 5px;
                gap: 5px;
            }
            
            .tags-input-field {
                min-width: 100px;
                font-size: 13px;
            }
            
            /* å†…å®¹è¿‡æ»¤å™¨æ ·å¼è°ƒæ•´ */
            .filter-tag {
                font-size: 0.85em;
                padding: 5px 10px;
            }
            
            .filter-tag-column {
                font-size: 0.9em;
            }
            
            .filter-tag-condition {
                font-size: 0.8em;
            }
            
            .filter-tag-remove {
                width: 18px;
                height: 18px;
                font-size: 14px;
            }
            
            /* åˆ—å†…å®¹è¿‡æ»¤åŒºåŸŸ - å°å±ä¼˜åŒ– */
            .content-filter-title {
                font-size: 1em;
            }
            
            .filter-logic-selector {
                width: 100%;
            }
            
            .filter-logic-label {
                font-size: 0.85em;
            }
            
            .filter-logic-text {
                font-size: 0.85em;
            }
            
            .clear-all-filters-btn {
                font-size: 13px;
                padding: 8px;
            }
            
            .filter-input,
            .filter-select {
                font-size: 13px;
                padding: 8px;
            }
            
            .filter-add-btn {
                font-size: 13px;
                padding: 10px;
            }
            
            .filter-row,
            .filter-input-row {
                padding: 10px;
            }
            
            .filter-row-input,
            .filter-row-select {
                font-size: 13px;
                padding: 8px;
            }
            
            .filter-row-delete-btn {
                font-size: 13px;
                padding: 8px;
            }
            
            /* è¡¨æ ¼ä¼˜åŒ– */
            .table-wrapper {
                max-height: 400px;
            }
            
            th, td {
                min-width: 70px;
            }
            
            /* æ¶ˆæ¯æç¤ºä¼˜åŒ– */
            .error-message,
            .success-message {
                padding: 10px;
                font-size: 13px;
                margin: 12px 0;
            }
        }

        /* è¶…å°å±æ‰‹æœº */
        @media (max-width: 360px) {
            .header h1 {
                font-size: 1.3em;
            }

            .header p {
                font-size: 0.85em;
            }

            .header p:last-child {
                font-size: 0.75em;
            }

            .btn {
                font-size: 12px;
                padding: 6px 12px;
                min-width: 90px;
            }

            .history-header h3 {
                font-size: 1em;
            }

            .data-table th {
                padding: 6px 4px;
                font-size: 0.8em;
            }

            .data-table td {
                padding: 5px 3px;
                font-size: 0.8em;
                max-width: 100px;
            }

            .pagination button {
                padding: 5px 8px;
                font-size: 0.75em;
            }
            
            /* åˆ—å†…å®¹è¿‡æ»¤åŒºåŸŸ - è¶…å°å±ä¼˜åŒ– */
            .content-filter-title {
                font-size: 0.95em;
            }
            
            .filter-logic-label {
                font-size: 0.8em;
            }
            
            .filter-logic-text {
                font-size: 0.8em;
            }
            
            .clear-all-filters-btn {
                font-size: 12px;
                padding: 6px;
            }
            
            .filter-input,
            .filter-select,
            .filter-row-input,
            .filter-row-select {
                font-size: 12px;
                padding: 6px;
            }
            
            .filter-add-btn {
                font-size: 12px;
                padding: 8px;
            }
            
            .filter-row,
            .filter-input-row {
                padding: 8px;
                gap: 8px;
            }
            
            .filter-row-delete-btn {
                font-size: 12px;
                padding: 6px;
            }
            
            /* è¡¨æ ¼ä¼˜åŒ– */
            .table-wrapper {
                max-height: 350px;
            }
            
            th, td {
                min-width: 60px;
            }
            
            /* æ¶ˆæ¯æç¤ºä¼˜åŒ– */
            .error-message,
            .success-message {
                padding: 8px;
                font-size: 12px;
                margin: 10px 0;
            }
        }
        
        /* è¡¨æ ¼æ¨ªå‘æ»šåŠ¨ä¼˜åŒ– */
        .data-table-container {
            -webkit-overflow-scrolling: touch;
        }
        
        /* è§¦æ‘¸ä¼˜åŒ– */
        @media (hover: none) and (pointer: coarse) {
            .btn,
            .pagination button,
            .column-toggle,
            .filter-add-btn,
            .filter-row-delete-btn,
            .clear-all-filters-btn {
                min-height: 44px;
                touch-action: manipulation;
            }
            
            .filter-input,
            .filter-select,
            .filter-row-input,
            .filter-row-select {
                min-height: 44px;
                font-size: 16px; /* é˜²æ­¢ iOS Safari è‡ªåŠ¨ç¼©æ”¾ */
            }
            
            input[type="text"],
            input[type="search"],
            textarea,
            select {
                font-size: 16px; /* é˜²æ­¢ iOS Safari è‡ªåŠ¨ç¼©æ”¾ */
            }
            
            .column-tag-remove,
            .filter-tag-remove {
                min-width: 32px;
                min-height: 32px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“Š JSONæ•°ç»„å±•ç¤ºå·¥å…·</h1>
            <p>æ”¯æŒåˆ†é¡µã€å¤šåˆ—æ’åºã€æœç´¢ã€åˆ—æ§åˆ¶å’Œåˆ—ç§»åŠ¨çš„JSONæ•°æ®å±•ç¤ºå·¥å…·</p>
            <p style="font-size: 0.9em; margin-top: 10px; opacity: 0.8;">
                ğŸ’¡ æç¤ºï¼šåŒå‡»å•å…ƒæ ¼å±•å¼€/æ”¶ç¼© | Shiftç‚¹å‡»åˆ—å¤´è¿›è¡Œå¤šåˆ—æ’åºï¼ˆæ— åºâ†’å‡åºâ†’é™åºâ†’æ— åºï¼‰
            </p>
        </div>

        <div class="main-content">
            <div class="input-section">
                <div class="input-group">
                    <label for="jsonInput">è¯·è¾“å…¥JSONæ•°ç»„æ•°æ®ï¼š</label>
                    <textarea id="jsonInput" placeholder='ä¾‹å¦‚ï¼š[{"id": 1, "name": "å¼ ä¸‰", "age": 25, "city": "åŒ—äº¬"}, {"id": 2, "name": "æå››", "age": 30, "city": "ä¸Šæµ·"}]'></textarea>
                </div>
                
                <!-- åˆ—è¿‡æ»¤è®¾ç½® -->
                <div class="input-group" style="margin-top: 15px; background: #f0f7ff; padding: 15px; border-radius: 8px; border: 1px solid #d0e7ff; position: relative;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <label style="margin: 0; font-weight: 600; color: #495057;">ğŸ¯ åˆ—è¿‡æ»¤è®¾ç½®</label>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <span style="font-size: 0.8em; color: #6c757d; background: white; padding: 4px 8px; border-radius: 4px; border: 1px solid #d0e7ff;">
                                ğŸ’¾ è®¾ç½®è‡ªåŠ¨ä¿å­˜
                            </span>
                            <button onclick="resetColumnFilterSettings()" 
                                    style="font-size: 0.8em; padding: 4px 10px; border: 1px solid #dee2e6; background: white; border-radius: 4px; cursor: pointer; color: #6c757d; transition: all 0.3s ease;"
                                    onmouseover="this.style.background='#f8f9fa'; this.style.borderColor='#4facfe'"
                                    onmouseout="this.style.background='white'; this.style.borderColor='#dee2e6'"
                                    title="é‡ç½®ä¸ºé»˜è®¤è®¾ç½®">
                                ğŸ”„ é‡ç½®
                            </button>
                        </div>
                    </div>
                    <div class="column-filter-options">
                        <label class="column-filter-option">
                            <input type="radio" name="columnFilterMode" value="all" checked onchange="updateColumnFilterUI()">
                            <span>æ˜¾ç¤ºæ‰€æœ‰åˆ—</span>
                        </label>
                        <label class="column-filter-option">
                            <input type="radio" name="columnFilterMode" value="include" onchange="updateColumnFilterUI()">
                            <span>ä»…æ˜¾ç¤ºæŒ‡å®šåˆ—</span>
                        </label>
                        <label class="column-filter-option">
                            <input type="radio" name="columnFilterMode" value="exclude" onchange="updateColumnFilterUI()">
                            <span>å¿½ç•¥æŒ‡å®šåˆ—</span>
                        </label>
                    </div>
                    <!-- æ ‡ç­¾è¾“å…¥å®¹å™¨ -->
                    <div id="tagsInputContainer" class="tags-input-container disabled" style="display: none;" onclick="focusTagsInput()">
                        <!-- æ ‡ç­¾å°†åŠ¨æ€æ·»åŠ åˆ°è¿™é‡Œ -->
                        <input type="text" 
                               id="columnFilterInput" 
                               class="tags-input-field"
                               placeholder="è¾“å…¥åˆ—ååæŒ‰å›è½¦æ·»åŠ ï¼Œä¾‹å¦‚ï¼šid"
                               disabled
                               autocomplete="off">
                    </div>
                    <div style="font-size: 0.85em; color: #6c757d; margin-top: 5px; display: none;" id="columnFilterHint">
                        ğŸ’¡ æç¤ºï¼šè¾“å…¥åˆ—ååæŒ‰ <kbd style="padding: 2px 6px; background: #f0f0f0; border: 1px solid #ccc; border-radius: 3px; font-size: 0.9em;">Enter</kbd> æ·»åŠ æ ‡ç­¾ï¼Œç‚¹å‡» âœ• åˆ é™¤
                    </div>
                </div>
                
                <div class="button-group">
                    <button class="btn btn-parse" onclick="parseAndDisplay()">
                        <span>ğŸ“Š</span> è§£æå¹¶å±•ç¤º
                    </button>
                    <button class="btn btn-secondary" onclick="formatJSON()">
                        <span>âœ¨</span> æ ¼å¼åŒ–
                    </button>
                    <button class="btn btn-export" onclick="exportToCSV()">
                        <span>ğŸ“¥</span> å¯¼å‡ºCSV
                    </button>
                    <button class="btn btn-history" onclick="toggleHistoryPanel()">
                        <span>ğŸ“š</span> å†å²è®°å½•
                    </button>
                </div>
            </div>

            <div id="messageContainer" style="display: none;"></div>

            <div id="historyPanel" class="history-panel" style="display: none;">
                <div class="history-header">
                    <h3>ğŸ“š å†å²è®°å½•</h3>
                    <div class="history-controls">
                        <button class="btn btn-clear-history" onclick="clearAllHistory()">
                            <span>ğŸ—‘ï¸</span> æ¸…ç©ºå…¨éƒ¨
                        </button>
                        <button class="btn btn-close" onclick="toggleHistoryPanel()">
                            <span>âœ–ï¸</span> å…³é—­
                        </button>
                    </div>
                </div>
                <div class="history-list" id="historyList">
                    <!-- å†å²è®°å½•åˆ—è¡¨å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>

            <div id="controlsSection" class="controls-section" style="display: none;">
                <!-- åˆ—å†…å®¹è¿‡æ»¤åŒºåŸŸ -->
                <div class="controls-row content-filter-section" id="contentFilterSection">
                    <!-- æ ‡é¢˜å’Œæ“ä½œæ  -->
                    <div class="content-filter-header">
                        <div>
                            <strong class="content-filter-title">ğŸ” åˆ—å†…å®¹è¿‡æ»¤</strong>
                        </div>
                        <div class="filter-logic-selector">
                            <span class="filter-logic-label">å¤šæ¡ä»¶é€»è¾‘ï¼š</span>
                            <label class="filter-logic-option">
                                <input type="radio" name="filterLogic" value="AND" checked onchange="applyContentFiltersAndDisplay()" class="filter-logic-radio">
                                <span class="filter-logic-text">AND (ä¸”)</span>
                            </label>
                            <label class="filter-logic-option">
                                <input type="radio" name="filterLogic" value="OR" onchange="applyContentFiltersAndDisplay()" class="filter-logic-radio">
                                <span class="filter-logic-text">OR (æˆ–)</span>
                            </label>
                        </div>
                        <button onclick="clearAllContentFilters()" id="clearAllFiltersBtn" class="clear-all-filters-btn" style="display: none;">
                            ğŸ—‘ï¸ æ¸…é™¤æ‰€æœ‰
                        </button>
                    </div>
                    
                    <!-- è¿‡æ»¤å™¨è¡Œå°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                    
                    <!-- æ·»åŠ æ–°è¿‡æ»¤å™¨çš„è¾“å…¥è¡Œ -->
                    <div class="filter-input-row">
                        <div class="filter-input-field">
                            <input type="text" id="filterColumnName" 
                                   placeholder="è¾“å…¥åˆ—å" 
                                   list="availableColumns"
                                   class="filter-input">
                            <datalist id="availableColumns"></datalist>
                        </div>
                        <div class="filter-condition-field">
                            <select id="filterCondition" class="filter-select">
                                <option value="contains">åŒ…å«</option>
                                <option value="equals">ç­‰äº</option>
                                <option value="notEquals">ä¸ç­‰äº</option>
                                <option value="startsWith">å¼€å¤´æ˜¯</option>
                                <option value="endsWith">ç»“å°¾æ˜¯</option>
                                <option value="greaterThan">å¤§äº</option>
                                <option value="lessThan">å°äº</option>
                                <option value="isEmpty">ä¸ºç©º</option>
                                <option value="notEmpty">ä¸ä¸ºç©º</option>
                            </select>
                        </div>
                        <div class="filter-input-field">
                            <input type="text" id="filterValue" 
                                   placeholder="è¾“å…¥è¿‡æ»¤å€¼" 
                                   list="availableValues"
                                   class="filter-input">
                            <datalist id="availableValues"></datalist>
                        </div>
                        <button class="btn btn-parse filter-add-btn" onclick="addContentFilter()">æ·»åŠ </button>
                    </div>
                </div>
                
                <div class="controls-row" id="columnControlsRow" style="display: none;">
                    <div class="column-controls" id="columnControls">
                        <!-- åˆ—æ§åˆ¶æŒ‰é’®å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>
                <div class="controls-row">
                    <div class="column-select-all">
                        <label>
                            <input type="checkbox" id="selectAllCheckbox" onchange="toggleAllColumns()">
                            <span>å…¨é€‰/å…¨ä¸é€‰åˆ—</span>
                        </label>
                        <button class="btn btn-sort-column" onclick="sortColumnsByName()" id="sortColumnsBtn">
                            <span id="sortColumnsIcon">ğŸ”¤</span> æŒ‰åˆ—åæ’åº
                        </button>
                        <button class="btn btn-toggle-columns" onclick="toggleColumnControls()" id="toggleColumnsBtn">
                            <span id="toggleColumnsIcon">ğŸ‘ï¸</span> æ˜¾ç¤ºåˆ—ç®¡ç†
                        </button>
                    </div>
                </div>
            </div>

            <div id="tableContainer" class="table-container" style="display: none;">
                <div class="table-search-controls">
                    <div class="search-box">
                        <input type="text" id="searchInput" placeholder="æœç´¢æ•°æ®...">
                        <span class="search-icon">ğŸ”</span>
                    </div>
                    <button class="btn btn-clear-sort" onclick="clearAllSorting()" id="clearSortBtn" style="display: none;">
                        <span>ğŸ”„</span> æ¸…é™¤æ‰€æœ‰æ’åº
                    </button>
                    <div class="pagination-controls">
                        <label>æ¯é¡µæ˜¾ç¤ºï¼š</label>
                        <select id="pageSizeSelect">
                            <option value="10">10æ¡</option>
                            <option value="25" selected>25æ¡</option>
                            <option value="50">50æ¡</option>
                            <option value="100">100æ¡</option>
                        </select>
                    </div>
                </div>
                <div class="table-wrapper">
                    <table id="dataTable">
                        <thead id="tableHead">
                            <!-- è¡¨å¤´å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                        </thead>
                        <tbody id="tableBody">
                            <!-- è¡¨æ ¼æ•°æ®å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                        </tbody>
                    </table>
                </div>
                <div class="stats" id="statsInfo">
                    <!-- ç»Ÿè®¡ä¿¡æ¯å°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
                </div>
                <div id="paginationContainer" class="pagination">
                    <!-- åˆ†é¡µæ§ä»¶å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentData = [];
        let filteredData = [];
        let currentPage = 1;
        let pageSize = 25;
        let sortColumns = []; // å¤šåˆ—æ’åº: [{column: 'name', direction: 'asc'}, ...]
        let visibleColumns = [];
        let columnOrder = [];
        let prettyPrintJSON = false; // æ˜¯å¦ç¾åŒ–JSONå¯¹è±¡æ˜¾ç¤º
        let columnTags = []; // å­˜å‚¨å½“å‰çš„åˆ—æ ‡ç­¾
        let contentFilters = []; // å­˜å‚¨åˆ—å†…å®¹è¿‡æ»¤å™¨: [{column, condition, value}, ...]
        
        // åˆ—è¿‡æ»¤è®¾ç½®
        function updateColumnFilterUI() {
            const filterMode = document.querySelector('input[name="columnFilterMode"]:checked').value;
            const filterInput = document.getElementById('columnFilterInput');
            const filterHint = document.getElementById('columnFilterHint');
            const tagsContainer = document.getElementById('tagsInputContainer');
            
            if (filterMode === 'all') {
                tagsContainer.style.display = 'none';
                tagsContainer.classList.add('disabled');
                filterInput.disabled = true;
                filterHint.style.display = 'none';
            } else {
                tagsContainer.style.display = 'flex';
                tagsContainer.classList.remove('disabled');
                filterInput.disabled = false;
                filterHint.style.display = 'block';
                
                if (filterMode === 'include') {
                    filterInput.placeholder = columnTags.length > 0 ? 'ç»§ç»­æ·»åŠ ...' : 'è¾“å…¥è¦æ˜¾ç¤ºçš„åˆ—ååæŒ‰å›è½¦';
                    filterHint.innerHTML = 'ğŸ’¡ æç¤ºï¼šè¾“å…¥åˆ—ååæŒ‰ <kbd style="padding: 2px 6px; background: #f0f0f0; border: 1px solid #ccc; border-radius: 3px; font-size: 0.9em;">Enter</kbd> æ·»åŠ æ ‡ç­¾ï¼Œæ”¯æŒå¸¦ç©ºæ ¼çš„åˆ—åã€‚å¤šä¸ªåˆ—åç”¨é€—å·æˆ–åˆ†å·åˆ†éš”';
                } else if (filterMode === 'exclude') {
                    filterInput.placeholder = columnTags.length > 0 ? 'ç»§ç»­æ·»åŠ ...' : 'è¾“å…¥è¦éšè—çš„åˆ—ååæŒ‰å›è½¦';
                    filterHint.innerHTML = 'ğŸ’¡ æç¤ºï¼šè¾“å…¥åˆ—ååæŒ‰ <kbd style="padding: 2px 6px; background: #f0f0f0; border: 1px solid #ccc; border-radius: 3px; font-size: 0.9em;">Enter</kbd> æ·»åŠ æ ‡ç­¾ï¼Œæ”¯æŒå¸¦ç©ºæ ¼çš„åˆ—åã€‚å¤šä¸ªåˆ—åç”¨é€—å·æˆ–åˆ†å·åˆ†éš”';
                }
            }
            
            // ä¿å­˜è®¾ç½®åˆ°ç¼“å­˜
            saveColumnFilterSettings();
        }
        
        // èšç„¦åˆ°æ ‡ç­¾è¾“å…¥æ¡†
        function focusTagsInput() {
            const filterInput = document.getElementById('columnFilterInput');
            if (filterInput && !filterInput.disabled) {
                filterInput.focus();
            }
        }
        
        // æ·»åŠ åˆ—æ ‡ç­¾
        function addColumnTag(columnName) {
            // æ¸…ç†è¾“å…¥
            columnName = columnName.trim();
            if (!columnName) return;
            
            // æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨
            if (columnTags.includes(columnName)) {
                showMessage(`åˆ— "${columnName}" å·²å­˜åœ¨`, 'error');
                return;
            }
            
            // æ·»åŠ åˆ°æ•°ç»„
            columnTags.push(columnName);
            
            // æ¸²æŸ“æ ‡ç­¾
            renderColumnTags();
            
            // æ¸…ç©ºè¾“å…¥æ¡†
            const filterInput = document.getElementById('columnFilterInput');
            filterInput.value = '';
            
            // æ›´æ–°å ä½ç¬¦
            updateColumnFilterUI();
            
            // ä¿å­˜è®¾ç½®
            saveColumnFilterSettings();
        }
        
        // åˆ é™¤åˆ—æ ‡ç­¾
        function removeColumnTag(columnName) {
            const index = columnTags.indexOf(columnName);
            if (index > -1) {
                columnTags.splice(index, 1);
                renderColumnTags();
                updateColumnFilterUI();
                saveColumnFilterSettings();
            }
        }
        
        // æ¸²æŸ“æ‰€æœ‰æ ‡ç­¾
        function renderColumnTags() {
            const tagsContainer = document.getElementById('tagsInputContainer');
            const filterInput = document.getElementById('columnFilterInput');
            
            // æ¸…é™¤ç°æœ‰æ ‡ç­¾
            const existingTags = tagsContainer.querySelectorAll('.column-tag');
            existingTags.forEach(tag => tag.remove());
            
            // åˆ›å»ºæ–°æ ‡ç­¾
            columnTags.forEach(columnName => {
                const tag = document.createElement('div');
                tag.className = 'column-tag';
                tag.innerHTML = `
                    <span class="column-tag-text" title="${columnName}">${columnName}</span>
                    <span class="column-tag-remove" onclick="removeColumnTag('${columnName}')" title="åˆ é™¤">âœ•</span>
                `;
                
                // åœ¨è¾“å…¥æ¡†å‰æ’å…¥
                tagsContainer.insertBefore(tag, filterInput);
            });
        }
        
        // åˆå§‹åŒ–æ ‡ç­¾è¾“å…¥äº‹ä»¶
        function initializeTagsInput() {
            const filterInput = document.getElementById('columnFilterInput');
            
            filterInput.addEventListener('keydown', function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    const value = this.value.trim();
                    if (value) {
                        // æ”¯æŒé€—å·å’Œåˆ†å·åˆ†éš”çš„å¤šä¸ªåˆ—åï¼ˆä¿ç•™ç©ºæ ¼ä»¥æ”¯æŒå¸¦ç©ºæ ¼çš„åˆ—åï¼‰
                        const columns = value.split(/[,ï¼Œ;ï¼›]+/).filter(col => col.trim());
                        columns.forEach(col => addColumnTag(col.trim()));
                    }
                } else if (e.key === 'Backspace' && this.value === '' && columnTags.length > 0) {
                    // åˆ é™¤æœ€åä¸€ä¸ªæ ‡ç­¾
                    e.preventDefault();
                    removeColumnTag(columnTags[columnTags.length - 1]);
                }
            });
            
            // å¤±ç„¦æ—¶å¤„ç†è¾“å…¥
            filterInput.addEventListener('blur', function() {
                const value = this.value.trim();
                if (value) {
                    // æ”¯æŒé€—å·å’Œåˆ†å·åˆ†éš”çš„å¤šä¸ªåˆ—åï¼ˆä¿ç•™ç©ºæ ¼ä»¥æ”¯æŒå¸¦ç©ºæ ¼çš„åˆ—åï¼‰
                    const columns = value.split(/[,ï¼Œ;ï¼›]+/).filter(col => col.trim());
                    columns.forEach(col => addColumnTag(col.trim()));
                }
            });
        }
        
        // åˆ—å†…å®¹è¿‡æ»¤ç›¸å…³å‡½æ•°
        
        // æ·»åŠ å†…å®¹è¿‡æ»¤å™¨
        function addContentFilter() {
            const columnName = document.getElementById('filterColumnName').value.trim();
            const condition = document.getElementById('filterCondition').value;
            const value = document.getElementById('filterValue').value.trim();
            
            if (!columnName) {
                showMessage('è¯·è¾“å…¥åˆ—å', 'error');
                return;
            }
            
            // æ£€æŸ¥åˆ—æ˜¯å¦å­˜åœ¨
            if (!columnOrder.includes(columnName)) {
                showMessage(`åˆ— "${columnName}" ä¸å­˜åœ¨`, 'error');
                return;
            }
            
            // æŸäº›æ¡ä»¶ä¸éœ€è¦å€¼
            if (!['isEmpty', 'notEmpty'].includes(condition) && !value) {
                showMessage('è¯·è¾“å…¥è¿‡æ»¤å€¼', 'error');
                return;
            }
            
            // æ·»åŠ åˆ°è¿‡æ»¤å™¨æ•°ç»„
            const filter = {
                id: Date.now(),
                column: columnName,
                condition: condition,
                value: value
            };
            
            contentFilters.push(filter);
            
            // æ¸…ç©ºè¾“å…¥
            document.getElementById('filterColumnName').value = '';
            document.getElementById('filterValue').value = '';
            
            // æ¸²æŸ“è¿‡æ»¤å™¨æ ‡ç­¾
            renderContentFilters();
            
            // é‡æ–°åº”ç”¨è¿‡æ»¤å¹¶æ˜¾ç¤ºæ•°æ®
            applyContentFiltersAndDisplay();
            
            showMessage(`å·²æ·»åŠ è¿‡æ»¤å™¨ï¼š${columnName}`, 'success');
        }
        
        // åˆ é™¤å†…å®¹è¿‡æ»¤å™¨
        function removeContentFilter(filterId) {
            contentFilters = contentFilters.filter(f => f.id !== filterId);
            renderContentFilters();
            applyContentFiltersAndDisplay();
            showMessage('è¿‡æ»¤å™¨å·²åˆ é™¤', 'success');
        }
        
        // æ¸…é™¤æ‰€æœ‰å†…å®¹è¿‡æ»¤å™¨
        function clearAllContentFilters() {
            if (contentFilters.length === 0) {
                showMessage('å½“å‰æ²¡æœ‰æ´»åŠ¨çš„è¿‡æ»¤å™¨', 'error');
                return;
            }
            
            const count = contentFilters.length;
            contentFilters = [];
            renderContentFilters();
            applyContentFiltersAndDisplay();
            showMessage(`å·²æ¸…é™¤æ‰€æœ‰ ${count} ä¸ªè¿‡æ»¤å™¨`, 'success');
        }
        
        // æ›´æ–°è¿‡æ»¤å™¨åˆ—å
        function updateFilterColumn(filterId, newColumn) {
            const filter = contentFilters.find(f => f.id === filterId);
            if (filter) {
                filter.column = newColumn.trim();
                applyContentFiltersAndDisplay();
            }
        }
        
        // æ›´æ–°è¿‡æ»¤å™¨åˆ—åå¹¶æ›´æ–°å¯ç”¨å€¼åˆ—è¡¨
        function updateFilterColumnAndValues(filterId, newColumn) {
            const filter = contentFilters.find(f => f.id === filterId);
            if (filter) {
                filter.column = newColumn.trim();
                // æ›´æ–°è¯¥è¿‡æ»¤å™¨çš„å¯ç”¨å€¼åˆ—è¡¨
                updateAvailableValuesForFilter(filterId, filter.column);
                applyContentFiltersAndDisplay();
            }
        }
        
        // ä¸ºç‰¹å®šè¿‡æ»¤å™¨æ›´æ–°å¯ç”¨å€¼æ¨èåˆ—è¡¨
        function updateAvailableValuesForFilter(filterId, columnName) {
            const datalist = document.getElementById(`availableValues_${filterId}`);
            
            // å¦‚æœ datalist ä¸å­˜åœ¨ï¼Œç›´æ¥è¿”å›
            if (!datalist) {
                return;
            }
            
            // æ¸…ç©ºç°æœ‰é€‰é¡¹
            datalist.innerHTML = '';
            
            // å¦‚æœåˆ—åä¸ºç©ºæˆ–æ•°æ®ä¸ºç©ºï¼Œä¸æä¾›æ¨è
            if (!columnName || !currentData || currentData.length === 0) {
                return;
            }
            
            // æ”¶é›†è¯¥åˆ—çš„æ‰€æœ‰å”¯ä¸€å€¼
            const uniqueValues = new Set();
            currentData.forEach(row => {
                const value = row[columnName];
                // æ’é™¤ nullã€undefined å’Œç©ºå­—ç¬¦ä¸²
                if (value !== null && value !== undefined && value !== '') {
                    uniqueValues.add(String(value));
                }
            });
            
            // å¦‚æœå”¯ä¸€å€¼å¤ªå¤šï¼ˆè¶…è¿‡100ä¸ªï¼‰ï¼Œåªæ˜¾ç¤ºå‰100ä¸ª
            const valuesToShow = Array.from(uniqueValues).sort().slice(0, 100);
            
            // æ·»åŠ åˆ° datalist
            valuesToShow.forEach(value => {
                const option = document.createElement('option');
                option.value = value;
                datalist.appendChild(option);
            });
        }
        
        // æ›´æ–°è¿‡æ»¤å™¨æ¡ä»¶
        function updateFilterCondition(filterId, newCondition) {
            const filter = contentFilters.find(f => f.id === filterId);
            if (filter) {
                filter.condition = newCondition;
                // å¦‚æœæ˜¯isEmptyæˆ–notEmptyï¼Œæ¸…ç©ºå€¼
                if (['isEmpty', 'notEmpty'].includes(newCondition)) {
                    filter.value = '';
                }
                renderContentFilters();
                applyContentFiltersAndDisplay();
            }
        }
        
        // æ›´æ–°è¿‡æ»¤å™¨å€¼
        function updateFilterValue(filterId, newValue) {
            const filter = contentFilters.find(f => f.id === filterId);
            if (filter) {
                filter.value = newValue.trim();
                applyContentFiltersAndDisplay();
            }
        }
        
        // æ¸²æŸ“å†…å®¹è¿‡æ»¤å™¨è¡Œ
        function renderContentFilters() {
            const section = document.getElementById('contentFilterSection');
            const clearBtn = document.getElementById('clearAllFiltersBtn');
            
            // æ˜¾ç¤ºæˆ–éšè—æ¸…é™¤æŒ‰é’®
            if (clearBtn) {
                clearBtn.style.display = contentFilters.length > 0 ? 'inline-block' : 'none';
            }
            
            // ç§»é™¤æ‰€æœ‰ç°æœ‰çš„è¿‡æ»¤å™¨è¡Œï¼ˆä¿ç•™æ ‡é¢˜å’Œæ·»åŠ è¾“å…¥è¡Œï¼‰
            const existingFilters = section.querySelectorAll('.filter-row');
            existingFilters.forEach(el => el.remove());
            
            if (contentFilters.length === 0) {
                return;
            }
            
            // æ‰¾åˆ°æ·»åŠ è¾“å…¥è¡Œ
            const addInputRow = section.lastElementChild;
            
            contentFilters.forEach((filter, index) => {
                // åˆ›å»ºè¿‡æ»¤å™¨è¡Œ
                const filterRow = document.createElement('div');
                filterRow.className = 'filter-row';
                
                filterRow.innerHTML = `
                    <div class="filter-row-field">
                        <input type="text" 
                               value="${filter.column}" 
                               oninput="updateFilterColumnAndValues(${filter.id}, this.value)"
                               list="availableColumns"
                               class="filter-row-input">
                    </div>
                    <div class="filter-row-condition">
                        <select onchange="updateFilterCondition(${filter.id}, this.value)" class="filter-row-select">
                            <option value="contains" ${filter.condition === 'contains' ? 'selected' : ''}>åŒ…å«</option>
                            <option value="equals" ${filter.condition === 'equals' ? 'selected' : ''}>ç­‰äº</option>
                            <option value="notEquals" ${filter.condition === 'notEquals' ? 'selected' : ''}>ä¸ç­‰äº</option>
                            <option value="startsWith" ${filter.condition === 'startsWith' ? 'selected' : ''}>å¼€å¤´æ˜¯</option>
                            <option value="endsWith" ${filter.condition === 'endsWith' ? 'selected' : ''}>ç»“å°¾æ˜¯</option>
                            <option value="greaterThan" ${filter.condition === 'greaterThan' ? 'selected' : ''}>å¤§äº</option>
                            <option value="lessThan" ${filter.condition === 'lessThan' ? 'selected' : ''}>å°äº</option>
                            <option value="isEmpty" ${filter.condition === 'isEmpty' ? 'selected' : ''}>ä¸ºç©º</option>
                            <option value="notEmpty" ${filter.condition === 'notEmpty' ? 'selected' : ''}>ä¸ä¸ºç©º</option>
                        </select>
                    </div>
                    <div class="filter-row-field">
                        <input type="text" 
                               value="${filter.value || ''}" 
                               onchange="updateFilterValue(${filter.id}, this.value)"
                               placeholder="è¾“å…¥è¿‡æ»¤å€¼"
                               list="availableValues_${filter.id}"
                               class="filter-row-input"
                               ${['isEmpty', 'notEmpty'].includes(filter.condition) ? 'disabled' : ''}>
                        <datalist id="availableValues_${filter.id}"></datalist>
                    </div>
                    <button onclick="removeContentFilter(${filter.id})" 
                            class="filter-row-delete-btn"
                            title="åˆ é™¤æ­¤è¿‡æ»¤æ¡ä»¶">åˆ é™¤</button>`;
                
                section.insertBefore(filterRow, addInputRow);
                
                // åˆå§‹åŒ–è¯¥è¿‡æ»¤å™¨è¡Œçš„å¯ç”¨å€¼åˆ—è¡¨
                updateAvailableValuesForFilter(filter.id, filter.column);
            });
        }
        
        // è·å–æ¡ä»¶æ–‡æœ¬
        function getConditionText(condition) {
            const conditionMap = {
                'contains': 'åŒ…å«',
                'equals': 'ç­‰äº',
                'notEquals': 'ä¸ç­‰äº',
                'startsWith': 'å¼€å¤´æ˜¯',
                'endsWith': 'ç»“å°¾æ˜¯',
                'greaterThan': 'å¤§äº',
                'lessThan': 'å°äº',
                'isEmpty': 'ä¸ºç©º',
                'notEmpty': 'ä¸ä¸ºç©º'
            };
            return conditionMap[condition] || condition;
        }
        
        // åº”ç”¨å†…å®¹è¿‡æ»¤å¹¶æ˜¾ç¤ºæ•°æ®
        function applyContentFiltersAndDisplay() {
            if (contentFilters.length === 0) {
                filteredData = [];
            } else {
                const filterLogic = document.querySelector('input[name="filterLogic"]:checked')?.value || 'AND';
                
                filteredData = currentData.filter(row => {
                    if (filterLogic === 'AND') {
                        // ANDå…³ç³»ï¼šæ‰€æœ‰è¿‡æ»¤å™¨éƒ½å¿…é¡»æ»¡è¶³
                        return contentFilters.every(filter => {
                            return matchFilter(row, filter);
                        });
                    } else {
                        // ORå…³ç³»ï¼šè‡³å°‘ä¸€ä¸ªè¿‡æ»¤å™¨æ»¡è¶³
                        return contentFilters.some(filter => {
                            return matchFilter(row, filter);
                        });
                    }
                });
            }
            
            currentPage = 1; // é‡ç½®åˆ°ç¬¬ä¸€é¡µ
            displayData();
        }
        
        // æ£€æŸ¥è¡Œæ˜¯å¦åŒ¹é…è¿‡æ»¤å™¨
        function matchFilter(row, filter) {
            const cellValue = row[filter.column];
            const filterValue = filter.value;
            
            // å¤„ç†null/undefined
            if (cellValue === null || cellValue === undefined) {
                if (filter.condition === 'isEmpty') return true;
                if (filter.condition === 'notEmpty') return false;
                return false;
            }
            
            // è½¬æ¢ä¸ºå­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒï¼ˆé™¤äº†æ•°å­—æ¯”è¾ƒï¼‰
            const cellStr = String(cellValue).toLowerCase();
            const filterStr = String(filterValue).toLowerCase();
            
            switch (filter.condition) {
                case 'contains':
                    return cellStr.includes(filterStr);
                    
                case 'equals':
                    // å°è¯•æ•°å­—æ¯”è¾ƒ
                    if (!isNaN(cellValue) && !isNaN(filterValue)) {
                        return Number(cellValue) === Number(filterValue);
                    }
                    return cellStr === filterStr;
                    
                case 'notEquals':
                    if (!isNaN(cellValue) && !isNaN(filterValue)) {
                        return Number(cellValue) !== Number(filterValue);
                    }
                    return cellStr !== filterStr;
                    
                case 'startsWith':
                    return cellStr.startsWith(filterStr);
                    
                case 'endsWith':
                    return cellStr.endsWith(filterStr);
                    
                case 'greaterThan':
                    if (!isNaN(cellValue) && !isNaN(filterValue)) {
                        return Number(cellValue) > Number(filterValue);
                    }
                    return cellStr > filterStr;
                    
                case 'lessThan':
                    if (!isNaN(cellValue) && !isNaN(filterValue)) {
                        return Number(cellValue) < Number(filterValue);
                    }
                    return cellStr < filterStr;
                    
                case 'isEmpty':
                    return cellStr === '' || cellStr === 'null' || cellStr === 'undefined';
                    
                case 'notEmpty':
                    return cellStr !== '' && cellStr !== 'null' && cellStr !== 'undefined';
                    
                default:
                    return true;
            }
        }
        
        // æ›´æ–°å¯ç”¨åˆ—ååˆ—è¡¨
        function updateAvailableColumns() {
            const datalist = document.getElementById('availableColumns');
            datalist.innerHTML = '';
            
            columnOrder.forEach(column => {
                const option = document.createElement('option');
                option.value = column;
                datalist.appendChild(option);
            });
        }
        
        // åº”ç”¨åˆ—è¿‡æ»¤è®¾ç½®
        function applyColumnFilter(allColumns) {
            const filterMode = document.querySelector('input[name="columnFilterMode"]:checked').value;
            
            if (filterMode === 'all') {
                return Array.from(allColumns);
            }
            
            // ä½¿ç”¨columnTagsæ•°ç»„è€Œä¸æ˜¯inputçš„value
            const specifiedColumns = columnTags;
            
            if (specifiedColumns.length === 0) {
                if (filterMode === 'include') {
                    showMessage('è¯·æ·»åŠ è¦æ˜¾ç¤ºçš„åˆ—åæ ‡ç­¾');
                    return Array.from(allColumns); // å¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œæ˜¾ç¤ºæ‰€æœ‰åˆ—
                } else {
                    return Array.from(allColumns);
                }
            }
            
            let resultColumns;
            if (filterMode === 'include') {
                // ç™½åå•æ¨¡å¼ï¼šä»…æ˜¾ç¤ºæŒ‡å®šçš„åˆ—
                resultColumns = specifiedColumns.filter(col => allColumns.has(col));
                const notFoundColumns = specifiedColumns.filter(col => !allColumns.has(col));
                
                if (notFoundColumns.length > 0) {
                    showMessage(`ä»¥ä¸‹åˆ—åä¸å­˜åœ¨ï¼š${notFoundColumns.join(', ')}`, 'error');
                }
                
                if (resultColumns.length === 0) {
                    showMessage('æŒ‡å®šçš„åˆ—åéƒ½ä¸å­˜åœ¨ï¼Œå°†æ˜¾ç¤ºæ‰€æœ‰åˆ—');
                    return Array.from(allColumns);
                } else {
                    showMessage(`å·²åº”ç”¨åˆ—è¿‡æ»¤ï¼šä»…æ˜¾ç¤º ${resultColumns.length} åˆ—`, 'success');
                }
            } else {
                // é»‘åå•æ¨¡å¼ï¼šå¿½ç•¥æŒ‡å®šçš„åˆ—
                resultColumns = Array.from(allColumns).filter(col => !specifiedColumns.includes(col));
                const foundColumns = specifiedColumns.filter(col => allColumns.has(col));
                
                if (foundColumns.length === 0) {
                    showMessage('æŒ‡å®šçš„åˆ—åéƒ½ä¸å­˜åœ¨ï¼Œå°†æ˜¾ç¤ºæ‰€æœ‰åˆ—', 'error');
                    return Array.from(allColumns);
                } else if (resultColumns.length === 0) {
                    showMessage('ä¸èƒ½å¿½ç•¥æ‰€æœ‰åˆ—ï¼Œå°†æ˜¾ç¤ºæ‰€æœ‰åˆ—', 'error');
                    return Array.from(allColumns);
                } else {
                    showMessage(`å·²åº”ç”¨åˆ—è¿‡æ»¤ï¼šå¿½ç•¥ ${foundColumns.length} åˆ—ï¼Œæ˜¾ç¤º ${resultColumns.length} åˆ—`, 'success');
                }
            }
            
            return resultColumns;
        }

        function showMessage(message, type = 'error') {
            const container = document.getElementById('messageContainer');
            container.innerHTML = `<div class="${type}-message">${message}</div>`;
            setTimeout(() => {
                container.innerHTML = '';
            }, 5000);
        }

        function parseAndDisplay() {
            const jsonInput = document.getElementById('jsonInput').value.trim();
            
            if (!jsonInput) {
                showMessage('è¯·è¾“å…¥JSONæ•°æ®');
                return;
            }

            try {
                const parsed = JSON.parse(jsonInput);
                
                if (!Array.isArray(parsed)) {
                    showMessage('è¯·è¾“å…¥æœ‰æ•ˆçš„JSONæ•°ç»„');
                    return;
                }

                if (parsed.length === 0) {
                    showMessage('JSONæ•°ç»„ä¸ºç©º');
                    return;
                }

                currentData = parsed;
                initializeTable();
                showMessage(`æˆåŠŸè§£æ ${parsed.length} æ¡æ•°æ®`, 'success');
                
                // è‡ªåŠ¨ä¿å­˜åˆ°å†å²è®°å½•
                saveToHistory(jsonInput);
                
            } catch (error) {
                showMessage(`JSONè§£æé”™è¯¯: ${error.message}`);
            }
        }

        function formatJSON() {
            const jsonInput = document.getElementById('jsonInput');
            const inputValue = jsonInput.value.trim();
            
            if (!inputValue) {
                showMessage('è¯·å…ˆè¾“å…¥JSONæ•°æ®');
                return;
            }

            try {
                // å°è¯•è§£æJSON
                const parsed = JSON.parse(inputValue);
                
                // æ ¼å¼åŒ–JSONï¼Œä½¿ç”¨2ä¸ªç©ºæ ¼ç¼©è¿›
                const formatted = JSON.stringify(parsed, null, 2);
                
                // æ›´æ–°è¾“å…¥æ¡†å†…å®¹
                jsonInput.value = formatted;
                
                showMessage('JSONæ ¼å¼åŒ–æˆåŠŸ', 'success');
                
            } catch (error) {
                showMessage(`JSONæ ¼å¼åŒ–å¤±è´¥: ${error.message}`);
            }
        }


        function initializeTable() {
            if (currentData.length === 0) return;

            // è·å–æ‰€æœ‰åˆ—å
            const allColumns = new Set();
            currentData.forEach(item => {
                Object.keys(item).forEach(key => allColumns.add(key));
            });

            // åº”ç”¨åˆ—è¿‡æ»¤è®¾ç½®
            let filteredColumns = applyColumnFilter(allColumns);
            
            if (filteredColumns.length === 0) {
                // å¦‚æœæ²¡æœ‰åˆ—å¯æ˜¾ç¤ºï¼Œåˆ™æ˜¾ç¤ºæ‰€æœ‰åˆ—
                filteredColumns = Array.from(allColumns);
            }

            // åˆå§‹åŒ–åˆ—é…ç½®
            visibleColumns = filteredColumns;
            columnOrder = Array.from(allColumns); // columnOrder åŒ…å«æ‰€æœ‰åˆ—ï¼Œä»¥ä¾¿åç»­ç®¡ç†
            
            // æ¸…é™¤æ‰€æœ‰æ’åº
            sortColumns = [];
            updateClearSortButton();

            // æ˜¾ç¤ºæ§åˆ¶åŒºåŸŸ
            document.getElementById('controlsSection').style.display = 'block';
            document.getElementById('tableContainer').style.display = 'block';

            // ç”Ÿæˆåˆ—æ§åˆ¶æŒ‰é’®
            generateColumnControls();
            
            // æ›´æ–°å¯ç”¨åˆ—ååˆ—è¡¨
            updateAvailableColumns();
            
            // åˆå§‹åŒ–æœç´¢å’Œåˆ†é¡µ
            setupEventListeners();
            
            // æ˜¾ç¤ºæ•°æ®
            displayData();
        }

        function generateColumnControls() {
            const container = document.getElementById('columnControls');
            container.innerHTML = '';

            columnOrder.forEach(column => {
                const button = document.createElement('div');
                button.className = `column-toggle ${visibleColumns.includes(column) ? 'active' : ''}`;
                button.innerHTML = `
                    <span class="drag-handle">â‹®â‹®</span>
                    <input type="checkbox" ${visibleColumns.includes(column) ? 'checked' : ''} 
                           onchange="toggleColumn('${column}')">
                    <span title="${column}">${column}</span>
                `;
                button.draggable = true;
                button.dataset.column = column;
                
                button.addEventListener('dragstart', handleDragStart);
                button.addEventListener('dragover', handleDragOver);
                button.addEventListener('drop', handleDrop);
                button.addEventListener('dragend', handleDragEnd);
                
                container.appendChild(button);
            });

            // æ›´æ–°å…¨é€‰/å…¨ä¸é€‰æŒ‰é’®çŠ¶æ€
            updateSelectAllButtons();
        }

        function updateSelectAllButtons() {
            const checkbox = document.getElementById('selectAllCheckbox');
            
            if (!checkbox) return;
            
            const allSelected = visibleColumns.length === columnOrder.length;
            const someSelected = visibleColumns.length > 0 && visibleColumns.length < columnOrder.length;
            
            if (allSelected) {
                // å…¨éƒ¨é€‰ä¸­
                checkbox.checked = true;
                checkbox.indeterminate = false;
            } else if (someSelected) {
                // éƒ¨åˆ†é€‰ä¸­ - ä½¿ç”¨ä¸ç¡®å®šçŠ¶æ€
                checkbox.checked = false;
                checkbox.indeterminate = true;
            } else {
                // å…¨éƒ¨æœªé€‰ä¸­
                checkbox.checked = false;
                checkbox.indeterminate = false;
            }
        }

        function toggleColumn(column) {
            if (visibleColumns.includes(column)) {
                visibleColumns = visibleColumns.filter(col => col !== column);
            } else {
                visibleColumns.push(column);
            }
            displayData();
            generateColumnControls();
        }

        function handleDragStart(e) {
            e.dataTransfer.setData('text/plain', e.target.dataset.column);
            e.target.classList.add('dragging');
        }

        function handleDragOver(e) {
            e.preventDefault();
        }

        function handleDrop(e) {
            e.preventDefault();
            const draggedColumn = e.dataTransfer.getData('text/plain');
            const targetColumn = e.target.dataset.column;
            
            if (draggedColumn && targetColumn && draggedColumn !== targetColumn) {
                const draggedIndex = columnOrder.indexOf(draggedColumn);
                const targetIndex = columnOrder.indexOf(targetColumn);
                
                columnOrder.splice(draggedIndex, 1);
                columnOrder.splice(targetIndex, 0, draggedColumn);
                
                generateColumnControls();
                displayData();
            }
        }

        function handleDragEnd(e) {
            e.target.classList.remove('dragging');
        }

        function setupEventListeners() {
            // æœç´¢åŠŸèƒ½
            document.getElementById('searchInput').addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase();
                filteredData = currentData.filter(item => {
                    return Object.values(item).some(value => 
                        String(value).toLowerCase().includes(searchTerm)
                    );
                });
                currentPage = 1;
                displayData();
            });

            // åˆ†é¡µå¤§å°å˜åŒ–
            document.getElementById('pageSizeSelect').addEventListener('change', function() {
                pageSize = parseInt(this.value);
                currentPage = 1;
                displayData();
            });
        }

        function displayData() {
            // åˆ›å»ºæ•°æ®å‰¯æœ¬ä»¥é¿å…ä¿®æ”¹åŸæ•°ç»„
            // å¦‚æœæœ‰å†…å®¹è¿‡æ»¤å™¨ï¼Œä½¿ç”¨ filteredDataï¼ˆå³ä½¿ä¸ºç©ºï¼‰ï¼›å¦åˆ™ä½¿ç”¨å…¨éƒ¨æ•°æ®
            const dataToShow = contentFilters.length > 0 ? [...filteredData] : [...currentData];
            
            // æ£€æŸ¥æ˜¯å¦æœ‰å†…å®¹è¿‡æ»¤å™¨ä½†æ²¡æœ‰ç»“æœ
            if (contentFilters.length > 0 && dataToShow.length === 0) {
                showEmptyFilterResult();
                return;
            }
            
            // å¤šåˆ—æ’åº
            if (sortColumns.length > 0) {
                dataToShow.sort((a, b) => {
                    // ä¾æ¬¡æŒ‰æ¯ä¸ªæ’åºåˆ—è¿›è¡Œæ¯”è¾ƒ
                    for (let i = 0; i < sortColumns.length; i++) {
                        const sortInfo = sortColumns[i];
                        const column = sortInfo.column;
                        const direction = sortInfo.direction;
                        
                        const aVal = a[column];
                        const bVal = b[column];
                        
                        // å¤„ç†null/undefinedå€¼
                        if (aVal === null || aVal === undefined) {
                            if (bVal === null || bVal === undefined) continue;
                            return 1;
                        }
                        if (bVal === null || bVal === undefined) return -1;
                        
                        let comparison = 0;
                        
                        // æ•°å­—æ¯”è¾ƒ
                        if (typeof aVal === 'number' && typeof bVal === 'number') {
                            comparison = aVal - bVal;
                        } 
                        // å­—ç¬¦ä¸²æ¯”è¾ƒ
                        else {
                            const aStr = String(aVal).toLowerCase();
                            const bStr = String(bVal).toLowerCase();
                            comparison = aStr.localeCompare(bStr, 'zh-CN');
                        }
                        
                        if (comparison !== 0) {
                            return direction === 'asc' ? comparison : -comparison;
                        }
                    }
                    return 0;
                });
            }

            // ç”Ÿæˆè¡¨å¤´
            generateTableHeader();
            
            // åˆ†é¡µè®¡ç®—
            const totalPages = Math.ceil(dataToShow.length / pageSize);
            const startIndex = (currentPage - 1) * pageSize;
            const endIndex = Math.min(startIndex + pageSize, dataToShow.length);
            const pageData = dataToShow.slice(startIndex, endIndex);

            // ç”Ÿæˆè¡¨æ ¼å†…å®¹
            generateTableBody(pageData);
            
            // ç”Ÿæˆåˆ†é¡µæ§ä»¶
            generatePagination(totalPages);
            
            // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
            updateStats(dataToShow.length, startIndex + 1, endIndex);
        }
        
        // æ˜¾ç¤ºç©ºè¿‡æ»¤ç»“æœ
        function showEmptyFilterResult() {
            const tbody = document.getElementById('tableBody');
            const filterLogic = document.querySelector('input[name="filterLogic"]:checked')?.value || 'AND';
            const logicText = filterLogic === 'AND' ? 'ä¸”' : 'æˆ–';
            
            // ç”Ÿæˆè¡¨å¤´
            generateTableHeader();
            
            // æ˜¾ç¤ºç©ºçŠ¶æ€
            tbody.innerHTML = `
                <tr>
                    <td colspan="${visibleColumns.length}" style="text-align: center; padding: 60px 20px;">
                        <div style="color: #6c757d;">
                            <div style="font-size: 3em; margin-bottom: 15px;">ğŸ”</div>
                            <div style="font-size: 1.2em; font-weight: 600; margin-bottom: 10px;">æœªæ‰¾åˆ°åŒ¹é…çš„æ•°æ®</div>
                            <div style="font-size: 0.95em; margin-bottom: 15px;">
                                å½“å‰ ${contentFilters.length} ä¸ªè¿‡æ»¤æ¡ä»¶ï¼ˆ${logicText}ï¼‰æœªåŒ¹é…åˆ°ä»»ä½•ç»“æœ
                            </div>
                            <div style="font-size: 0.85em; color: #adb5bd;">
                                ğŸ’¡ å°è¯•ï¼š
                                <br>â€¢ è°ƒæ•´è¿‡æ»¤æ¡ä»¶çš„å€¼
                                <br>â€¢ åˆ‡æ¢ AND/OR é€»è¾‘
                                <br>â€¢ åˆ é™¤éƒ¨åˆ†è¿‡æ»¤æ¡ä»¶
                            </div>
                        </div>
                    </td>
                </tr>
            `;
            
            // éšè—åˆ†é¡µ
            document.getElementById('paginationContainer').style.display = 'none';
            
            // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
            const statsContainer = document.getElementById('statsInfo');
            const filterInfo = `<div style="color: #dc3545;">è¿‡æ»¤: ${contentFilters.length} ä¸ªæ¡ä»¶ (${logicText}) | åŸå§‹æ•°æ®: ${currentData.length} æ¡ | åŒ¹é…ç»“æœ: 0 æ¡</div>`;
            statsContainer.innerHTML = filterInfo;
        }

        function generateTableHeader() {
            const thead = document.getElementById('tableHead');
            thead.innerHTML = '';

            const tr = document.createElement('tr');
            columnOrder.forEach(column => {
                if (visibleColumns.includes(column)) {
                    const th = document.createElement('th');
                    th.className = 'sortable';
                    th.onclick = () => sortByColumn(column);
                    
                    // æŸ¥æ‰¾è¯¥åˆ—çš„æ’åºä¿¡æ¯
                    const sortIndex = sortColumns.findIndex(s => s.column === column);
                    
                    if (sortIndex !== -1) {
                        const sortInfo = sortColumns[sortIndex];
                        th.classList.add(`sort-${sortInfo.direction}`);
                        
                        // å¦‚æœæœ‰å¤šä¸ªæ’åºåˆ—ï¼Œæ˜¾ç¤ºæ’åºä¼˜å…ˆçº§
                        if (sortColumns.length > 1) {
                            th.innerHTML = `${column} <small style="opacity: 0.8;">(${sortIndex + 1})</small>`;
                        } else {
                            th.textContent = column;
                        }
                    } else {
                        th.textContent = column;
                    }
                    
                    tr.appendChild(th);
                }
            });
            thead.appendChild(tr);
        }

        function generateTableBody(data) {
            const tbody = document.getElementById('tableBody');
            tbody.innerHTML = '';

            data.forEach(item => {
                const tr = document.createElement('tr');
                columnOrder.forEach(column => {
                    if (visibleColumns.includes(column)) {
                        const td = document.createElement('td');
                        const value = item[column];
                        let displayText = '';
                        
                        if (value === null || value === undefined) {
                            displayText = '-';
                            td.textContent = displayText;
                            td.style.color = '#6c757d';
                            td.style.fontStyle = 'italic';
                        } else if (typeof value === 'object' && value !== null) {
                            // å°†JSONå¯¹è±¡è½¬æ¢ä¸ºå­—ç¬¦ä¸²å±•ç¤ºï¼ˆä¸ç¾åŒ–ï¼Œä¿æŒå•è¡Œï¼‰
                            displayText = JSON.stringify(value);
                            td.textContent = displayText;
                            // td.style.fontFamily = "'Courier New', monospace";
                            // td.style.fontSize = '0.9em';
                            // td.style.color = '#0066cc';
                            
                            // ä¿å­˜åŸå§‹å¯¹è±¡ï¼Œç”¨äºå±•å¼€æ—¶ç¾åŒ–æ˜¾ç¤º
                            td.dataset.jsonValue = displayText;
                            td.dataset.isJson = 'true';
                        } else {
                            displayText = String(value);
                            td.textContent = displayText;
                        }
                        
                        // æ·»åŠ data-tooltipå±æ€§ç”¨äºæ‚¬åœæç¤º
                        // å¦‚æœæ˜¯JSONå¯¹è±¡ï¼Œæ‚¬åœæ—¶æ˜¾ç¤ºç¾åŒ–åçš„ç‰ˆæœ¬
                        if (typeof value === 'object' && value !== null) {
                            const prettyJson = JSON.stringify(value, null, 2);
                            td.setAttribute('data-tooltip', prettyJson);
                        } else if (displayText) {
                            td.setAttribute('data-tooltip', displayText);
                        }
                        
                        // æ·»åŠ åŒå‡»å±•å¼€/æ”¶ç¼©åŠŸèƒ½
                        td.addEventListener('dblclick', () => {
                            if (td.classList.contains('expanded')) {
                                // æ”¶ç¼©ï¼šæ¢å¤ä¸ºå•è¡ŒJSON
                                td.classList.remove('expanded');
                                if (td.dataset.isJson === 'true') {
                                    td.textContent = td.dataset.jsonValue;
                                }
                            } else {
                                // å±•å¼€ï¼šå¦‚æœæ˜¯JSONå¯¹è±¡ï¼Œç¾åŒ–æ˜¾ç¤º
                                td.classList.add('expanded');
                                if (td.dataset.isJson === 'true') {
                                    try {
                                        const obj = JSON.parse(td.dataset.jsonValue);
                                        td.textContent = JSON.stringify(obj, null, 2);
                                    } catch (e) {
                                        // å¦‚æœè§£æå¤±è´¥ï¼Œä¿æŒåŸæ ·
                                    }
                                }
                            }
                        });
                        
                        tr.appendChild(td);
                    }
                });
                tbody.appendChild(tr);
            });
        }

        function generatePagination(totalPages) {
            const container = document.getElementById('paginationContainer');
            container.innerHTML = '';
            container.style.display = totalPages > 1 ? 'flex' : 'none';

            if (totalPages <= 1) return;

            // ä¸Šä¸€é¡µæŒ‰é’®
            const prevBtn = document.createElement('button');
            prevBtn.textContent = 'ä¸Šä¸€é¡µ';
            prevBtn.disabled = currentPage === 1;
            prevBtn.onclick = () => {
                if (currentPage > 1) {
                    currentPage--;
                    displayData();
                }
            };
            container.appendChild(prevBtn);

            // é¡µç æŒ‰é’®
            const startPage = Math.max(1, currentPage - 2);
            const endPage = Math.min(totalPages, currentPage + 2);

            if (startPage > 1) {
                const firstBtn = document.createElement('button');
                firstBtn.textContent = '1';
                firstBtn.onclick = () => {
                    currentPage = 1;
                    displayData();
                };
                container.appendChild(firstBtn);

                if (startPage > 2) {
                    const ellipsis = document.createElement('span');
                    ellipsis.textContent = '...';
                    ellipsis.style.padding = '8px';
                    container.appendChild(ellipsis);
                }
            }

            for (let i = startPage; i <= endPage; i++) {
                const pageBtn = document.createElement('button');
                pageBtn.textContent = i;
                pageBtn.className = i === currentPage ? 'current-page' : '';
                pageBtn.onclick = () => {
                    currentPage = i;
                    displayData();
                };
                container.appendChild(pageBtn);
            }

            if (endPage < totalPages) {
                if (endPage < totalPages - 1) {
                    const ellipsis = document.createElement('span');
                    ellipsis.textContent = '...';
                    ellipsis.style.padding = '8px';
                    container.appendChild(ellipsis);
                }

                const lastBtn = document.createElement('button');
                lastBtn.textContent = totalPages;
                lastBtn.onclick = () => {
                    currentPage = totalPages;
                    displayData();
                };
                container.appendChild(lastBtn);
            }

            // ä¸‹ä¸€é¡µæŒ‰é’®
            const nextBtn = document.createElement('button');
            nextBtn.textContent = 'ä¸‹ä¸€é¡µ';
            nextBtn.disabled = currentPage === totalPages;
            nextBtn.onclick = () => {
                if (currentPage < totalPages) {
                    currentPage++;
                    displayData();
                }
            };
            container.appendChild(nextBtn);
        }

        function sortByColumn(column) {
            // æŸ¥æ‰¾è¯¥åˆ—æ˜¯å¦å·²åœ¨æ’åºåˆ—è¡¨ä¸­
            const sortIndex = sortColumns.findIndex(s => s.column === column);
            
            if (sortIndex === -1) {
                // è¯¥åˆ—æœªæ’åºï¼Œæ·»åŠ ä¸ºå‡åºæ’åº
                sortColumns.push({ column: column, direction: 'asc' });
                showMessage(`å·²æ·»åŠ  "${column}" åˆ—å‡åºæ’åº (ä¼˜å…ˆçº§: ${sortColumns.length})`, 'success');
            } else {
                const currentDirection = sortColumns[sortIndex].direction;
                
                if (currentDirection === 'asc') {
                    // ä»å‡åºæ”¹ä¸ºé™åº
                    sortColumns[sortIndex].direction = 'desc';
                    showMessage(`"${column}" åˆ—å·²æ”¹ä¸ºé™åºæ’åº (ä¼˜å…ˆçº§: ${sortIndex + 1})`, 'success');
                } else {
                    // ä»é™åºç§»é™¤æ’åº
                    sortColumns.splice(sortIndex, 1);
                    showMessage(`å·²å–æ¶ˆ "${column}" åˆ—çš„æ’åº`, 'success');
                }
            }
            
            // æ˜¾ç¤ºæˆ–éšè—æ¸…é™¤æ’åºæŒ‰é’®
            updateClearSortButton();
            
            displayData();
        }

        function clearAllSorting() {
            if (sortColumns.length === 0) {
                showMessage('å½“å‰æ²¡æœ‰æ’åº', 'success');
                return;
            }
            
            const count = sortColumns.length;
            sortColumns = [];
            updateClearSortButton();
            displayData();
            showMessage(`å·²æ¸…é™¤æ‰€æœ‰ ${count} ä¸ªæ’åº`, 'success');
        }

        function updateClearSortButton() {
            const clearBtn = document.getElementById('clearSortBtn');
            if (clearBtn) {
                clearBtn.style.display = sortColumns.length > 0 ? 'inline-flex' : 'none';
            }
        }

        function updateStats(total, start, end) {
            const statsContainer = document.getElementById('statsInfo');
            
            let sortInfo = '';
            if (sortColumns.length > 0) {
                const sortTexts = sortColumns.map((s, index) => 
                    `${s.column} (${s.direction === 'asc' ? 'â†‘å‡åº' : 'â†“é™åº'})`
                );
                sortInfo = `<div>æ’åº: ${sortTexts.join(' â†’ ')}</div>`;
            }
            
            let filterInfo = '';
            if (contentFilters.length > 0) {
                const filterLogic = document.querySelector('input[name="filterLogic"]:checked')?.value || 'AND';
                const logicText = filterLogic === 'AND' ? 'ä¸”' : 'æˆ–';
                filterInfo = `<div>è¿‡æ»¤: ${contentFilters.length} ä¸ªæ¡ä»¶ (${logicText}) | åŸå§‹æ•°æ®: ${currentData.length} æ¡</div>`;
            }
            
            statsContainer.innerHTML = `
                <div>æ˜¾ç¤º ${start}-${end} æ¡ï¼Œå…± ${total} æ¡æ•°æ®</div>
                <div>å½“å‰é¡µ: ${currentPage} / ${Math.ceil(total / pageSize)}</div>
                ${filterInfo}
                ${sortInfo}
            `;
        }

        function exportToCSV() {
            if (currentData.length === 0) {
                showMessage('æ²¡æœ‰æ•°æ®å¯å¯¼å‡º');
                return;
            }

            const dataToExport = filteredData.length > 0 ? filteredData : currentData;
            const columns = columnOrder.filter(col => visibleColumns.includes(col));
            
            // ç”ŸæˆCSVå†…å®¹
            let csvContent = columns.join(',') + '\n';
            
            dataToExport.forEach(item => {
                const row = columns.map(col => {
                    const value = item[col];
                    if (value === null || value === undefined) return '';
                    if (typeof value === 'object') return JSON.stringify(value);
                    return String(value).replace(/,/g, 'ï¼Œ'); // æ›¿æ¢é€—å·é¿å…CSVæ ¼å¼é—®é¢˜
                });
                csvContent += row.join(',') + '\n';
            });

            // ä¸‹è½½æ–‡ä»¶
            const blob = new Blob(['\ufeff' + csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `json_data_${new Date().toISOString().slice(0, 10)}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showMessage('CSVæ–‡ä»¶å·²å¯¼å‡º', 'success');
        }

        function toggleAllColumns() {
            const checkbox = document.getElementById('selectAllCheckbox');
            
            if (checkbox.checked) {
                // å…¨é€‰
                visibleColumns = [...columnOrder];
                showMessage(`å·²å…¨é€‰æ‰€æœ‰ ${columnOrder.length} åˆ—`, 'success');
            } else {
                // å…¨ä¸é€‰
                visibleColumns = [];
                showMessage('å·²å–æ¶ˆé€‰æ‹©æ‰€æœ‰åˆ—', 'success');
            }
            
            displayData();
            generateColumnControls();
        }

        // åˆ—æ’åºçŠ¶æ€ï¼š'none' | 'asc' | 'desc'
        let columnSortOrder = 'none';
        
        // åˆ—æ§åˆ¶æ˜¾ç¤ºçŠ¶æ€
        let columnControlsVisible = false;

        function toggleColumnControls() {
            const columnControlsRow = document.getElementById('columnControlsRow');
            const toggleBtn = document.getElementById('toggleColumnsBtn');
            
            columnControlsVisible = !columnControlsVisible;
            
            if (columnControlsVisible) {
                columnControlsRow.style.display = 'flex';
                toggleBtn.innerHTML = '<span id="toggleColumnsIcon">ğŸ™ˆ</span> éšè—åˆ—ç®¡ç†';
            } else {
                columnControlsRow.style.display = 'none';
                toggleBtn.innerHTML = '<span id="toggleColumnsIcon">ğŸ‘ï¸</span> æ˜¾ç¤ºåˆ—ç®¡ç†';
            }
        }

        function sortColumnsByName() {
            const sortIcon = document.getElementById('sortColumnsIcon');
            
            if (columnSortOrder === 'none' || columnSortOrder === 'desc') {
                // å‡åºæ’åº
                columnOrder.sort((a, b) => a.localeCompare(b, 'zh-CN'));
                columnSortOrder = 'asc';
                sortIcon.textContent = 'ğŸ”¤â†‘';
                showMessage('åˆ—å·²æŒ‰åç§°å‡åºæ’åº', 'success');
            } else {
                // é™åºæ’åº
                columnOrder.sort((a, b) => b.localeCompare(a, 'zh-CN'));
                columnSortOrder = 'desc';
                sortIcon.textContent = 'ğŸ”¤â†“';
                showMessage('åˆ—å·²æŒ‰åç§°é™åºæ’åº', 'success');
            }
            
            displayData();
            generateColumnControls();
        }

        // å†å²è®°å½•ç›¸å…³åŠŸèƒ½
        const HISTORY_KEY = 'json_table_history';
        const MAX_HISTORY_COUNT = 20;
        
        // åˆ—è¿‡æ»¤è®¾ç½®ç¼“å­˜
        const COLUMN_FILTER_KEY = 'json_table_column_filter_settings';
        
        // ä¿å­˜åˆ—è¿‡æ»¤è®¾ç½®åˆ°æœ¬åœ°å­˜å‚¨
        function saveColumnFilterSettings() {
            try {
                const filterMode = document.querySelector('input[name="columnFilterMode"]:checked').value;
                
                const settings = {
                    mode: filterMode,
                    tags: columnTags, // ä¿å­˜æ ‡ç­¾æ•°ç»„è€Œä¸æ˜¯å­—ç¬¦ä¸²
                    timestamp: new Date().toISOString()
                };
                
                localStorage.setItem(COLUMN_FILTER_KEY, JSON.stringify(settings));
                console.log('åˆ—è¿‡æ»¤è®¾ç½®å·²ä¿å­˜åˆ°ç¼“å­˜:', settings);
            } catch (error) {
                console.error('ä¿å­˜åˆ—è¿‡æ»¤è®¾ç½®å¤±è´¥:', error);
            }
        }
        
        // ä»æœ¬åœ°å­˜å‚¨åŠ è½½åˆ—è¿‡æ»¤è®¾ç½®
        function loadColumnFilterSettings() {
            try {
                const settingsStr = localStorage.getItem(COLUMN_FILTER_KEY);
                if (!settingsStr) {
                    console.log('æœªæ‰¾åˆ°ç¼“å­˜çš„åˆ—è¿‡æ»¤è®¾ç½®');
                    return;
                }
                
                const settings = JSON.parse(settingsStr);
                
                // è®¾ç½®è¿‡æ»¤æ¨¡å¼
                const modeRadio = document.querySelector(`input[name="columnFilterMode"][value="${settings.mode}"]`);
                if (modeRadio) {
                    modeRadio.checked = true;
                }
                
                // åŠ è½½æ ‡ç­¾ï¼ˆå…¼å®¹æ—§æ ¼å¼çš„columnså­—ç¬¦ä¸²ï¼‰
                if (settings.tags && Array.isArray(settings.tags)) {
                    columnTags = settings.tags;
                } else if (settings.columns && typeof settings.columns === 'string') {
                    // å…¼å®¹æ—§ç‰ˆæœ¬çš„é€—å·åˆ†éš”å­—ç¬¦ä¸²
                    columnTags = settings.columns
                        .split(/[,;ï¼Œï¼›\s]+/)
                        .map(col => col.trim())
                        .filter(col => col.length > 0);
                }
                
                // æ¸²æŸ“æ ‡ç­¾
                renderColumnTags();
                
                // æ›´æ–°UIæ˜¾ç¤º
                updateColumnFilterUI();
                
                console.log('å·²ä»ç¼“å­˜åŠ è½½åˆ—è¿‡æ»¤è®¾ç½®:', settings);
            } catch (error) {
                console.error('åŠ è½½åˆ—è¿‡æ»¤è®¾ç½®å¤±è´¥:', error);
            }
        }
        
        // æ¸…é™¤åˆ—è¿‡æ»¤è®¾ç½®ç¼“å­˜
        function clearColumnFilterSettings() {
            try {
                localStorage.removeItem(COLUMN_FILTER_KEY);
                console.log('åˆ—è¿‡æ»¤è®¾ç½®ç¼“å­˜å·²æ¸…é™¤');
            } catch (error) {
                console.error('æ¸…é™¤åˆ—è¿‡æ»¤è®¾ç½®å¤±è´¥:', error);
            }
        }
        
        // é‡ç½®åˆ—è¿‡æ»¤è®¾ç½®ä¸ºé»˜è®¤å€¼
        function resetColumnFilterSettings() {
            // æ¸…é™¤ç¼“å­˜
            clearColumnFilterSettings();
            
            // æ¸…ç©ºæ ‡ç­¾æ•°ç»„
            columnTags = [];
            
            // é‡ç½®UIä¸ºé»˜è®¤å€¼
            const allRadio = document.querySelector('input[name="columnFilterMode"][value="all"]');
            if (allRadio) {
                allRadio.checked = true;
            }
            
            const filterInput = document.getElementById('columnFilterInput');
            if (filterInput) {
                filterInput.value = '';
            }
            
            // é‡æ–°æ¸²æŸ“æ ‡ç­¾
            renderColumnTags();
            
            // æ›´æ–°UI
            updateColumnFilterUI();
            
            showMessage('åˆ—è¿‡æ»¤è®¾ç½®å·²é‡ç½®ä¸ºé»˜è®¤å€¼', 'success');
        }

        function saveToHistory(jsonData) {
            try {
                const history = getHistory();
                const timestamp = new Date().toISOString();
                const preview = generatePreview(jsonData);
                const title = generateTitle(jsonData);
                const detailedInfo = generateDetailedInfo(jsonData);
                
                // æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨ç›¸åŒçš„æ•°æ®
                const existingIndex = history.findIndex(item => item.data === jsonData);
                if (existingIndex !== -1) {
                    // å¦‚æœå­˜åœ¨ï¼Œç§»é™¤æ—§è®°å½•
                    history.splice(existingIndex, 1);
                }
                
                // æ·»åŠ æ–°è®°å½•åˆ°å¼€å¤´
                history.unshift({
                    id: Date.now(),
                    title: title,
                    data: jsonData,
                    preview: preview,
                    timestamp: timestamp,
                    detailedInfo: detailedInfo
                });
                
                // é™åˆ¶å†å²è®°å½•æ•°é‡
                if (history.length > MAX_HISTORY_COUNT) {
                    history.splice(MAX_HISTORY_COUNT);
                }
                
                localStorage.setItem(HISTORY_KEY, JSON.stringify(history));
                return true;
            } catch (error) {
                console.error('ä¿å­˜å†å²è®°å½•å¤±è´¥:', error);
                return false;
            }
        }

        function getHistory() {
            try {
                const history = localStorage.getItem(HISTORY_KEY);
                return history ? JSON.parse(history) : [];
            } catch (error) {
                console.error('è·å–å†å²è®°å½•å¤±è´¥:', error);
                return [];
            }
        }

        function generateTitle(jsonData) {
            try {
                const data = JSON.parse(jsonData);
                if (Array.isArray(data)) {
                    return `JSONæ•°ç»„ (${data.length} æ¡è®°å½•)`;
                } else {
                    return 'JSONå¯¹è±¡';
                }
            } catch {
                return 'JSONæ•°æ®';
            }
        }

        function generatePreview(jsonData) {
            try {
                const data = JSON.parse(jsonData);
                if (Array.isArray(data) && data.length > 0) {
                    const firstItem = data[0];
                    const keys = Object.keys(firstItem);
                    return `åŒ…å«å­—æ®µ: ${keys.join(', ')}`;
                } else if (typeof data === 'object') {
                    const keys = Object.keys(data);
                    return `å¯¹è±¡å­—æ®µ: ${keys.join(', ')}`;
                }
                return 'JSONæ•°æ®';
            } catch {
                return 'æ— æ•ˆçš„JSONæ•°æ®';
            }
        }

        function generateDetailedInfo(jsonData) {
            try {
                const data = JSON.parse(jsonData);
                if (Array.isArray(data) && data.length > 0) {
                    const firstItem = data[0];
                    const keys = Object.keys(firstItem);
                    const sampleData = keys.slice(0, 5).map(key => {
                        const value = firstItem[key];
                        const displayValue = typeof value === 'object' ? JSON.stringify(value) : String(value);
                        return `${key}: ${displayValue.length > 50 ? displayValue.substring(0, 50) + '...' : displayValue}`;
                    }).join('\n');
                    
                    return {
                        type: 'array',
                        count: data.length,
                        fields: keys,
                        sampleData: sampleData,
                        allFields: keys.join(', ')
                    };
                } else if (typeof data === 'object') {
                    const keys = Object.keys(data);
                    const sampleData = keys.slice(0, 5).map(key => {
                        const value = data[key];
                        const displayValue = typeof value === 'object' ? JSON.stringify(value) : String(value);
                        return `${key}: ${displayValue.length > 50 ? displayValue.substring(0, 50) + '...' : displayValue}`;
                    }).join('\n');
                    
                    return {
                        type: 'object',
                        count: 1,
                        fields: keys,
                        sampleData: sampleData,
                        allFields: keys.join(', ')
                    };
                }
                return {
                    type: 'unknown',
                    count: 0,
                    fields: [],
                    sampleData: 'æ— æ•°æ®',
                    allFields: ''
                };
            } catch {
                return {
                    type: 'error',
                    count: 0,
                    fields: [],
                    sampleData: 'JSONè§£æé”™è¯¯',
                    allFields: ''
                };
            }
        }

        function toggleHistoryPanel() {
            const panel = document.getElementById('historyPanel');
            if (panel.style.display === 'none') {
                panel.style.display = 'block';
                loadHistoryList();
            } else {
                panel.style.display = 'none';
            }
        }

        function loadHistoryList() {
            const historyList = document.getElementById('historyList');
            const history = getHistory();
            
            if (history.length === 0) {
                historyList.innerHTML = '<div class="empty-history">æš‚æ— å†å²è®°å½•</div>';
                return;
            }
            
            historyList.innerHTML = '';
            history.forEach(item => {
                const historyItem = document.createElement('div');
                historyItem.className = 'history-item';
                
                // è·å–è¯¦ç»†ä¿¡æ¯
                const detailedInfo = item.detailedInfo || generateDetailedInfo(item.data);
                
                historyItem.innerHTML = `
                    <div class="history-item-header">
                        <div class="history-item-title">${item.title}</div>
                        <div class="history-item-time">${formatTime(item.timestamp)}</div>
                    </div>
                    <div class="history-item-stats">
                        <div class="history-item-stat">
                            <span>ğŸ“Š</span> ç±»å‹: <span>${detailedInfo.type === 'array' ? 'æ•°ç»„' : detailedInfo.type === 'object' ? 'å¯¹è±¡' : 'æœªçŸ¥'}</span>
                        </div>
                        <div class="history-item-stat">
                            <span>ğŸ“</span> æ•°é‡: <span>${detailedInfo.count}</span>
                        </div>
                        <div class="history-item-stat">
                            <span>ğŸ·ï¸</span> å­—æ®µ: <span>${detailedInfo.fields.length}</span>
                        </div>
                    </div>
                    <div class="history-item-preview">${item.preview}</div>
                    <div class="history-item-details" id="details-${item.id}"><strong>å­—æ®µåˆ—è¡¨:</strong>
${detailedInfo.allFields || 'æ— '}

${detailedInfo.sampleData ? '<strong>ç¤ºä¾‹æ•°æ®:</strong>\n' + detailedInfo.sampleData : ''}</div>
                    <div class="history-item-actions">
                        <button onclick="loadHistoryItem('${item.id}')">åŠ è½½</button>
                        <button class="toggle-details-btn" onclick="toggleHistoryDetails('${item.id}', event)">è¯¦æƒ…</button>
                        <button class="delete-btn" onclick="deleteHistoryItem('${item.id}')">åˆ é™¤</button>
                    </div>
                `;
                historyList.appendChild(historyItem);
            });
        }

        function loadHistoryItem(id) {
            const history = getHistory();
            const item = history.find(h => h.id.toString() === id);
            if (item) {
                document.getElementById('jsonInput').value = item.data;
                
                // ç›´æ¥è§£ææ•°æ®ï¼Œä¸ä¿å­˜åˆ°å†å²è®°å½•ï¼ˆé¿å…é‡å¤ä¿å­˜ï¼‰
                try {
                    const parsed = JSON.parse(item.data);
                    if (Array.isArray(parsed) && parsed.length > 0) {
                        currentData = parsed;
                        initializeTable();
                        showMessage('å†å²è®°å½•å·²åŠ è½½', 'success');
                        toggleHistoryPanel();
                    } else {
                        showMessage('å†å²è®°å½•æ•°æ®æ— æ•ˆ');
                    }
                } catch (error) {
                    showMessage('å†å²è®°å½•æ•°æ®æ ¼å¼é”™è¯¯');
                }
            }
        }

        function deleteHistoryItem(id) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™æ¡å†å²è®°å½•å—ï¼Ÿ')) {
                const history = getHistory();
                const filteredHistory = history.filter(h => h.id.toString() !== id);
                localStorage.setItem(HISTORY_KEY, JSON.stringify(filteredHistory));
                loadHistoryList();
                showMessage('å†å²è®°å½•å·²åˆ é™¤', 'success');
            }
        }

        function clearAllHistory() {
            if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰å†å²è®°å½•å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚')) {
                localStorage.removeItem(HISTORY_KEY);
                loadHistoryList();
                showMessage('æ‰€æœ‰å†å²è®°å½•å·²æ¸…ç©º', 'success');
            }
        }

        function toggleHistoryDetails(id, event) {
            const detailsElement = document.getElementById(`details-${id}`);
            const button = event ? event.target : document.querySelector(`button[onclick*="toggleHistoryDetails('${id}')"]`);
            
            if (!detailsElement) {
                console.error('Details element not found for id:', id);
                return;
            }
            
            if (detailsElement.classList.contains('expanded')) {
                detailsElement.classList.remove('expanded');
                if (button) button.textContent = 'è¯¦æƒ…';
            } else {
                detailsElement.classList.add('expanded');
                if (button) button.textContent = 'æ”¶èµ·';
            }
        }

        function formatTime(timestamp) {
            const date = new Date(timestamp);
            const now = new Date();
            const diff = now - date;
            
            if (diff < 60000) { // 1åˆ†é’Ÿå†…
                return 'åˆšåˆš';
            } else if (diff < 3600000) { // 1å°æ—¶å†…
                return `${Math.floor(diff / 60000)}åˆ†é’Ÿå‰`;
            } else if (diff < 86400000) { // 1å¤©å†…
                return `${Math.floor(diff / 3600000)}å°æ—¶å‰`;
            } else {
                return date.toLocaleDateString() + ' ' + date.toLocaleTimeString();
            }
        }


        // åˆå§‹åŒ–å†…å®¹è¿‡æ»¤è¾“å…¥
        function initializeContentFilterInput() {
            const filterColumnInput = document.getElementById('filterColumnName');
            const filterValueInput = document.getElementById('filterValue');
            const filterConditionSelect = document.getElementById('filterCondition');
            
            // ç›‘å¬å›è½¦é”®
            [filterColumnInput, filterValueInput].forEach(input => {
                input.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        addContentFilter();
                    }
                });
            });
            
            // å½“é€‰æ‹©"ä¸ºç©º"æˆ–"ä¸ä¸ºç©º"æ—¶ï¼Œç¦ç”¨å€¼è¾“å…¥æ¡†
            filterConditionSelect.addEventListener('change', function() {
                const condition = this.value;
                if (['isEmpty', 'notEmpty'].includes(condition)) {
                    filterValueInput.disabled = true;
                    filterValueInput.value = '';
                    filterValueInput.style.backgroundColor = '#e9ecef';
                } else {
                    filterValueInput.disabled = false;
                    filterValueInput.style.backgroundColor = '';
                }
            });
            
            // å½“åˆ—åæ”¹å˜æ—¶ï¼Œæ›´æ–°å¯ç”¨å€¼çš„æ¨èåˆ—è¡¨
            filterColumnInput.addEventListener('input', function() {
                updateAvailableValuesForColumn(this.value);
            });
        }
        
        // æ›´æ–°æŒ‡å®šåˆ—çš„å¯ç”¨å€¼æ¨èåˆ—è¡¨
        function updateAvailableValuesForColumn(columnName) {
            const datalist = document.getElementById('availableValues');
            
            // æ¸…ç©ºç°æœ‰é€‰é¡¹
            datalist.innerHTML = '';
            
            // å¦‚æœåˆ—åä¸ºç©ºæˆ–æ•°æ®ä¸ºç©ºï¼Œä¸æä¾›æ¨è
            if (!columnName || !currentData || currentData.length === 0) {
                return;
            }
            
            // æ”¶é›†è¯¥åˆ—çš„æ‰€æœ‰å”¯ä¸€å€¼
            const uniqueValues = new Set();
            currentData.forEach(row => {
                const value = row[columnName];
                // æ’é™¤ nullã€undefined å’Œç©ºå­—ç¬¦ä¸²
                if (value !== null && value !== undefined && value !== '') {
                    uniqueValues.add(String(value));
                }
            });
            
            // å¦‚æœå”¯ä¸€å€¼å¤ªå¤šï¼ˆè¶…è¿‡100ä¸ªï¼‰ï¼Œåªæ˜¾ç¤ºå‰100ä¸ª
            const valuesToShow = Array.from(uniqueValues).sort().slice(0, 100);
            
            // æ·»åŠ åˆ° datalist
            valuesToShow.forEach(value => {
                const option = document.createElement('option');
                option.value = value;
                datalist.appendChild(option);
            });
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // åˆå§‹åŒ–æ ‡ç­¾è¾“å…¥åŠŸèƒ½
            initializeTagsInput();
            
            // åˆå§‹åŒ–å†…å®¹è¿‡æ»¤è¾“å…¥
            initializeContentFilterInput();
            
            // åŠ è½½åˆ—è¿‡æ»¤è®¾ç½®
            loadColumnFilterSettings();
        });
    </script>
</body>
</html>
