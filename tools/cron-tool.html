<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cronè¡¨è¾¾å¼ç”Ÿæˆå·¥å…· - åœ¨çº¿Cronè¡¨è¾¾å¼ç”Ÿæˆå™¨ | æ”¯æŒQuartzã€Spring</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="å…è´¹åœ¨çº¿Cronè¡¨è¾¾å¼ç”Ÿæˆå·¥å…·ï¼Œæ”¯æŒå¯è§†åŒ–é…ç½®å®šæ—¶ä»»åŠ¡Cronè¡¨è¾¾å¼ã€‚æ”¯æŒQuartzå’ŒSpringæ ¼å¼ï¼Œæä¾›å¸¸ç”¨è¡¨è¾¾å¼æ¨¡æ¿ï¼Œæ“ä½œç®€å•ï¼Œé€‚åˆå¼€å‘è€…ä½¿ç”¨ã€‚">
    <meta name="keywords" content="Cronè¡¨è¾¾å¼,Cronç”Ÿæˆå™¨,å®šæ—¶ä»»åŠ¡,Quartz,Spring,åœ¨çº¿Cronå·¥å…·,å®šæ—¶å™¨é…ç½®">
    <meta name="author" content="å¤šåŠŸèƒ½å·¥å…·ç®±">
    <meta name="robots" content="index, follow">
    <meta name="language" content="zh-CN">
    <!-- Canonical URL -->
    <link rel="canonical" href="https://www.seekpie.com/tools/cron-tool.html">
    
    <!-- Structured Data (JSON-LD) -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "Cronè¡¨è¾¾å¼ç”Ÿæˆå·¥å…·",
      "description": "å…è´¹åœ¨çº¿Cronè¡¨è¾¾å¼ç”Ÿæˆå·¥å…·ï¼Œæ”¯æŒå¯è§†åŒ–é…ç½®å®šæ—¶ä»»åŠ¡",
      "url": "https://www.seekpie.com/tools/cron-tool.html",
      "applicationCategory": "DeveloperApplication",
      "operatingSystem": "All",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "CNY"
      },
      "featureList": [
        "å¯è§†åŒ–é…ç½®",
        "Quartzæ ¼å¼æ”¯æŒ",
        "Springæ ¼å¼æ”¯æŒ",
        "å¸¸ç”¨è¡¨è¾¾å¼æ¨¡æ¿",
        "å®æ—¶é¢„è§ˆ"
      ]
    }
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: clamp(10px, 2vw, 20px);
            font-size: clamp(14px, 1.5vw, 16px);
        }

        .container {
            max-width: min(1400px, 70vw);
            margin: 0 auto;
            background: white;
            border-radius: clamp(12px, 2vw, 15px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: clamp(20px, 4vw, 30px);
            text-align: center;
        }

        .header h1 {
            font-size: clamp(1.5em, 3.5vw, 2.5em);
            margin-bottom: clamp(8px, 1.5vw, 10px);
            font-weight: 300;
        }

        .header p {
            font-size: clamp(0.9em, 2vw, 1.1em);
            opacity: 0.9;
        }

        .content {
            padding: clamp(20px, 4vw, 40px);
        }

        .section {
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 1.3em;
            color: #333;
            margin-bottom: 15px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .result-box {
            background: #f8f9fa;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .cron-display {
            background: white;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 1.8em;
            font-weight: 600;
            text-align: center;
            color: #667eea;
            letter-spacing: 2px;
            word-break: break-all;
            margin-bottom: 15px;
            cursor: text;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .cron-display:hover {
            border-color: #4facfe;
            background: #f8fcff;
        }

        .cron-display:focus {
            outline: none;
            border-color: #667eea;
            background: white;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .cron-description {
            background: #e7f3ff;
            padding: 15px;
            border-radius: 8px;
            color: #1976D2;
            margin-top: 15px;
            line-height: 1.6;
        }

        .cron-builder {
            display: grid;
            gap: 20px;
        }

        .cron-field {
            background: white;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .cron-field:hover {
            border-color: #4facfe;
            box-shadow: 0 2px 8px rgba(79, 172, 254, 0.1);
        }

        .cron-field-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .cron-field-label {
            font-weight: 600;
            color: #333;
            font-size: 1.1em;
        }

        .cron-field-value {
            font-family: 'Consolas', 'Monaco', monospace;
            background: #e7f3ff;
            padding: 5px 12px;
            border-radius: 5px;
            color: #1976D2;
            font-weight: 600;
        }

        .cron-field-type {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        .type-btn {
            flex: 1;
            min-width: 100px;
            padding: 10px 15px;
            border: 2px solid #e1e5e9;
            background: #f8f9fa;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.95em;
            font-weight: 500;
            text-align: center;
        }

        .type-btn:hover {
            border-color: #4facfe;
            background: white;
        }

        .type-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
        }

        .cron-field-config {
            display: none;
        }

        .cron-field-config.active {
            display: block;
        }

        .input-group {
            margin-bottom: 15px;
        }

        .input-group label {
            display: block;
            font-weight: 500;
            color: #555;
            margin-bottom: 8px;
            font-size: 0.95em;
        }

        input[type="number"], input[type="text"], select {
            width: 100%;
            padding: 10px 12px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        input[type="number"]:focus, input[type="text"]:focus, select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .range-inputs {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 10px;
            align-items: center;
        }

        .range-separator {
            text-align: center;
            font-weight: 600;
            color: #666;
        }

        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 8px 10px;
            background: #f8f9fa;
            border: 2px solid #e1e5e9;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .checkbox-item:hover {
            border-color: #4facfe;
            background: white;
        }

        .checkbox-item input[type="checkbox"]:checked + label {
            font-weight: 600;
        }

        .checkbox-item.checked {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
        }

        .checkbox-item input[type="checkbox"] {
            width: 16px;
            height: 16px;
            cursor: pointer;
        }

        .checkbox-item label {
            cursor: pointer;
            font-size: 0.9em;
        }

        .button-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 25px;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-success:hover {
            background: #218838;
            transform: translateY(-2px);
        }

        .btn-parse {
            background: #fd7e14;
            color: white;
        }

        .btn-parse:hover {
            background: #e96d06;
            transform: translateY(-2px);
        }

        .btn-save {
            background: #6f42c1;
            color: white;
        }

        .btn-save:hover {
            background: #5a32a3;
            transform: translateY(-2px);
        }

        .templates-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .template-card {
            background: white;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .template-card:hover {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.2);
        }

        .template-card-title {
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
            font-size: 1em;
        }

        .template-card-cron {
            font-family: 'Consolas', 'Monaco', monospace;
            color: #667eea;
            font-size: 1.1em;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .template-card-desc {
            font-size: 0.9em;
            color: #666;
            line-height: 1.4;
        }

        .next-runs {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
        }

        .next-runs h4 {
            color: #333;
            margin-bottom: 10px;
            font-size: 1em;
        }

        .next-runs-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .next-run-item {
            padding: 8px 12px;
            background: #f8f9fa;
            border-radius: 5px;
            font-size: 0.95em;
            color: #555;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .history-section {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #e1e5e9;
        }

        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .history-header h3 {
            color: #333;
            font-size: 1.2em;
        }

        .clear-history-btn {
            padding: 8px 16px;
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s ease;
        }

        .clear-history-btn:hover {
            background: #c82333;
            transform: scale(1.05);
        }

        .history-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
            max-height: 400px;
            overflow-y: auto;
        }

        .history-item {
            background: white;
            border: 1px solid #e1e5e9;
            border-radius: 8px;
            padding: 15px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .history-item:hover {
            border-color: #4facfe;
            box-shadow: 0 2px 8px rgba(79, 172, 254, 0.1);
        }

        .history-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .history-item-cron {
            font-family: 'Consolas', 'Monaco', monospace;
            font-weight: 600;
            color: #667eea;
            font-size: 1.1em;
        }

        .history-item-actions {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .history-item-date {
            color: #666;
            font-size: 0.85em;
        }

        .delete-history-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8em;
            transition: all 0.3s ease;
            opacity: 0.7;
        }

        .delete-history-btn:hover {
            background: #c82333;
            opacity: 1;
            transform: scale(1.05);
        }

        .history-item-desc {
            color: #555;
            font-size: 0.9em;
        }

        .empty-history {
            text-align: center;
            padding: 40px;
            color: #999;
        }

        .empty-history div {
            font-size: 2em;
            margin-bottom: 10px;
        }

        /* ç§»åŠ¨ç«¯ä¼˜åŒ– */
        /* è¶…å¤§å±å¹•ä¼˜åŒ– */
        @media (min-width: 1920px) {
            body {
                font-size: 18px;
            }
            
            .container {
                max-width: 1400px;
            }
        }

        /* å¤§å±å¹•ä¼˜åŒ– (æ¡Œé¢) */
        @media (min-width: 1200px) and (max-width: 1919px) {
            .container {
                max-width: min(1200px, 70vw);
            }
        }

        /* å¹³æ¿æ¨ªå± */
        @media (min-width: 769px) and (max-width: 1199px) {
            .container {
                max-width: min(1000px, 85vw);
            }
        }

        /* å¹³æ¿ç«–å±å’Œç§»åŠ¨ç«¯æ¨ªå± */
        @media (max-width: 768px) {
            .container {
                max-width: 95vw;
            }
            body {
                padding: 10px;
            }

            .content {
                padding: 20px 15px;
            }

            .header {
                padding: 20px 15px;
            }

            .header h1 {
                font-size: 1.8em;
                margin-bottom: 8px;
            }

            .header p {
                font-size: 0.95em;
            }

            .section-title {
                font-size: 1.2em;
            }

            .cron-display {
                font-size: 1.3em;
                padding: 15px;
                letter-spacing: 1px;
                min-height: 60px;
            }

            .cron-display:empty:before {
                content: 'ç‚¹å‡»è¾“å…¥Cronè¡¨è¾¾å¼...';
                color: #999;
                font-size: 0.7em;
            }

            .templates-grid {
                grid-template-columns: 1fr;
            }

            .button-group {
                flex-direction: column;
            }

            .btn {
                width: 100%;
            }

            .cron-field-type {
                flex-direction: column;
            }

            .type-btn {
                width: 100%;
            }

            .checkbox-group {
                grid-template-columns: repeat(3, 1fr);
            }

            .history-section {
                margin-top: 25px;
                padding: 20px 15px;
                background: #f8f9fa;
                border-radius: 10px;
                border-top: none;
            }

            .history-header {
                flex-direction: column;
                gap: 12px;
                align-items: stretch;
            }

            .history-header h3 {
                font-size: 1.3em;
                text-align: center;
            }

            .clear-history-btn {
                width: 100%;
                padding: 10px 20px;
                font-size: 1em;
            }

            .history-item {
                padding: 12px;
            }

            .history-item-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }

            .history-item-actions {
                width: 100%;
                justify-content: space-between;
            }

            .history-item-cron {
                font-size: 1em;
            }
        }

        /* å°å±æ‰‹æœºä¼˜åŒ– */
        @media (max-width: 480px) {
            body {
                padding: 8px;
            }

            .content {
                padding: 15px 12px;
            }

            .header {
                padding: 15px 12px;
            }

            .header h1 {
                font-size: 1.5em;
            }

            .header p {
                font-size: 0.9em;
            }

            .section-title {
                font-size: 1.1em;
            }

            .cron-display {
                font-size: 1.1em;
                padding: 12px;
                min-height: 55px;
            }

            .cron-display:empty:before {
                content: 'ç‚¹å‡»è¾“å…¥...';
                color: #999;
                font-size: 0.8em;
            }

            .cron-field {
                padding: 15px 12px;
            }

            .btn {
                padding: 10px 20px;
                font-size: 0.95em;
            }

            .checkbox-group {
                grid-template-columns: repeat(2, 1fr);
                gap: 8px;
            }

            .template-card {
                padding: 12px;
            }

            .template-card-cron {
                font-size: 1em;
            }
        }

        /* è¶…å°å±æ‰‹æœº */
        @media (max-width: 360px) {
            .header h1 {
                font-size: 1.3em;
            }

            .header p {
                font-size: 0.85em;
            }

            .section-title {
                font-size: 1em;
            }

            .cron-display {
                font-size: 1em;
                padding: 10px;
                min-height: 50px;
            }

            .cron-display:empty:before {
                content: 'è¾“å…¥è¡¨è¾¾å¼...';
                color: #999;
                font-size: 0.85em;
            }

            .btn {
                font-size: 0.9em;
                padding: 10px 16px;
            }

            .checkbox-group {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* è§¦æ‘¸è®¾å¤‡ä¼˜åŒ– */
        @media (hover: none) and (pointer: coarse) {
            .btn, .template-card, .type-btn, .checkbox-item {
                min-height: 44px;
            }

            .template-card:active {
                transform: scale(0.98);
            }

            .btn:active {
                transform: translateY(0) scale(0.98);
            }

            .type-btn:active {
                transform: scale(0.95);
            }

            .result-box, .history-list {
                -webkit-overflow-scrolling: touch;
            }
        }

        /* æ¨ªå±æ¨¡å¼ä¼˜åŒ–ï¼ˆç§»åŠ¨è®¾å¤‡ï¼‰ */
        @media (max-width: 768px) and (orientation: landscape) {
            body {
                padding: 8px;
            }
            
            .header {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 1.5em;
                margin-bottom: 5px;
            }
            
            .header p {
                font-size: 0.85em;
            }
            
            .content {
                padding: 15px;
            }
        }

        /* æ‰“å°æ ·å¼ä¼˜åŒ– */
        @media print {
            body {
                background: white;
                padding: 0;
            }
            
            .container {
                box-shadow: none;
                max-width: 100%;
            }
            
            .header {
                background: #4facfe !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            
            .btn, .button-group {
                display: none;
            }
            
            .section {
                page-break-inside: avoid;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>â° Cronè¡¨è¾¾å¼ç”Ÿæˆå·¥å…·</h1>
            <p>å¯è§†åŒ–é…ç½®å®šæ—¶ä»»åŠ¡ï¼Œæ”¯æŒQuartzå’ŒSpringæ ¼å¼</p>
        </div>

        <div class="content">
            <!-- Cronè¡¨è¾¾å¼æ˜¾ç¤º -->
            <div class="section">
                <div class="result-box">
                    <div class="cron-display" id="cronDisplay" contenteditable="true" spellcheck="false" title="ç‚¹å‡»ç¼–è¾‘Cronè¡¨è¾¾å¼ï¼ŒæŒ‰å›è½¦é”®è§£æ">* * * * * ?</div>
                    <div class="cron-description" id="cronDescription">
                        æ¯ç§’æ‰§è¡Œä¸€æ¬¡
                    </div>
                    <div class="next-runs" id="nextRuns">
                        <h4>ğŸ“… æ¥ä¸‹æ¥5æ¬¡æ‰§è¡Œæ—¶é—´ï¼š</h4>
                        <div class="next-runs-list" id="nextRunsList"></div>
                    </div>
                </div>
            </div>

            <!-- æ“ä½œæŒ‰é’® -->
            <div class="button-group">
                <button class="btn btn-primary" onclick="copyCron(event)">ğŸ“‹ å¤åˆ¶è¡¨è¾¾å¼</button>
                <button class="btn btn-primary" onclick="parseCronInput(event)">ğŸ”„ è§£æè¡¨è¾¾å¼</button>
                <button class="btn btn-primary" onclick="saveCron(event)">ğŸ’¾ ä¿å­˜åˆ°å†å²</button>
                <button class="btn btn-secondary" onclick="resetAll()">ğŸ”„ é‡ç½®</button>
            </div>

            <!-- Cronæ„å»ºå™¨ -->
            <div class="section">
                <div class="section-title">ğŸ”§ é…ç½®Cronè¡¨è¾¾å¼</div>
                <div class="cron-builder" id="cronBuilder">
                    <!-- ç§’ -->
                    <div class="cron-field">
                        <div class="cron-field-header">
                            <span class="cron-field-label">ç§’ (Second)</span>
                            <span class="cron-field-value" id="secondValue">*</span>
                        </div>
                        <div class="cron-field-type">
                            <div class="type-btn active" onclick="setFieldType('second', 'every')">æ¯ç§’</div>
                            <div class="type-btn" onclick="setFieldType('second', 'interval')">é—´éš”</div>
                            <div class="type-btn" onclick="setFieldType('second', 'range')">èŒƒå›´</div>
                            <div class="type-btn" onclick="setFieldType('second', 'specific')">æŒ‡å®š</div>
                        </div>
                        <div class="cron-field-config" id="second-interval">
                            <div class="input-group">
                                <label>ä»ç¬¬å‡ ç§’å¼€å§‹ï¼ˆå¯é€‰ï¼Œç•™ç©ºè¡¨ç¤ºä»0å¼€å§‹ï¼‰</label>
                                <input type="number" id="secondIntervalStart" min="0" max="59" value="" placeholder="ç•™ç©ºè¡¨ç¤ºä»0å¼€å§‹" onchange="updateCron()">
                            </div>
                            <div class="input-group">
                                <label>æ¯éš”å¤šå°‘ç§’</label>
                                <input type="number" id="secondIntervalValue" min="1" max="59" value="5" onchange="updateCron()">
                            </div>
                        </div>
                        <div class="cron-field-config" id="second-range">
                            <label>ç§’æ•°èŒƒå›´</label>
                            <div class="range-inputs">
                                <input type="number" id="secondRangeStart" min="0" max="59" value="0" onchange="updateCron()">
                                <span class="range-separator">-</span>
                                <input type="number" id="secondRangeEnd" min="0" max="59" value="30" onchange="updateCron()">
                            </div>
                        </div>
                        <div class="cron-field-config" id="second-specific">
                            <label>é€‰æ‹©ç§’æ•°ï¼ˆå¯å¤šé€‰ï¼‰</label>
                            <div class="checkbox-group" id="secondCheckboxes"></div>
                        </div>
                    </div>

                    <!-- åˆ†é’Ÿ -->
                    <div class="cron-field">
                        <div class="cron-field-header">
                            <span class="cron-field-label">åˆ†é’Ÿ (Minute)</span>
                            <span class="cron-field-value" id="minuteValue">*</span>
                        </div>
                        <div class="cron-field-type">
                            <div class="type-btn active" onclick="setFieldType('minute', 'every')">æ¯åˆ†é’Ÿ</div>
                            <div class="type-btn" onclick="setFieldType('minute', 'interval')">é—´éš”</div>
                            <div class="type-btn" onclick="setFieldType('minute', 'range')">èŒƒå›´</div>
                            <div class="type-btn" onclick="setFieldType('minute', 'specific')">æŒ‡å®š</div>
                        </div>
                        <div class="cron-field-config" id="minute-interval">
                            <div class="input-group">
                                <label>ä»ç¬¬å‡ åˆ†é’Ÿå¼€å§‹ï¼ˆå¯é€‰ï¼Œç•™ç©ºè¡¨ç¤ºä»0å¼€å§‹ï¼‰</label>
                                <input type="number" id="minuteIntervalStart" min="0" max="59" value="" placeholder="ç•™ç©ºè¡¨ç¤ºä»0å¼€å§‹" onchange="updateCron()">
                            </div>
                            <div class="input-group">
                                <label>æ¯éš”å¤šå°‘åˆ†é’Ÿ</label>
                                <input type="number" id="minuteIntervalValue" min="1" max="59" value="5" onchange="updateCron()">
                            </div>
                        </div>
                        <div class="cron-field-config" id="minute-range">
                            <label>åˆ†é’ŸèŒƒå›´</label>
                            <div class="range-inputs">
                                <input type="number" id="minuteRangeStart" min="0" max="59" value="0" onchange="updateCron()">
                                <span class="range-separator">-</span>
                                <input type="number" id="minuteRangeEnd" min="0" max="59" value="30" onchange="updateCron()">
                            </div>
                        </div>
                        <div class="cron-field-config" id="minute-specific">
                            <label>é€‰æ‹©åˆ†é’Ÿï¼ˆå¯å¤šé€‰ï¼‰</label>
                            <div class="checkbox-group" id="minuteCheckboxes"></div>
                        </div>
                    </div>

                    <!-- å°æ—¶ -->
                    <div class="cron-field">
                        <div class="cron-field-header">
                            <span class="cron-field-label">å°æ—¶ (Hour)</span>
                            <span class="cron-field-value" id="hourValue">*</span>
                        </div>
                        <div class="cron-field-type">
                            <div class="type-btn active" onclick="setFieldType('hour', 'every')">æ¯å°æ—¶</div>
                            <div class="type-btn" onclick="setFieldType('hour', 'interval')">é—´éš”</div>
                            <div class="type-btn" onclick="setFieldType('hour', 'range')">èŒƒå›´</div>
                            <div class="type-btn" onclick="setFieldType('hour', 'specific')">æŒ‡å®š</div>
                        </div>
                        <div class="cron-field-config" id="hour-interval">
                            <div class="input-group">
                                <label>ä»ç¬¬å‡ å°æ—¶å¼€å§‹ï¼ˆå¯é€‰ï¼Œç•™ç©ºè¡¨ç¤ºä»0å¼€å§‹ï¼‰</label>
                                <input type="number" id="hourIntervalStart" min="0" max="23" value="" placeholder="ç•™ç©ºè¡¨ç¤ºä»0å¼€å§‹" onchange="updateCron()">
                            </div>
                            <div class="input-group">
                                <label>æ¯éš”å¤šå°‘å°æ—¶</label>
                                <input type="number" id="hourIntervalValue" min="1" max="23" value="1" onchange="updateCron()">
                            </div>
                        </div>
                        <div class="cron-field-config" id="hour-range">
                            <label>å°æ—¶èŒƒå›´</label>
                            <div class="range-inputs">
                                <input type="number" id="hourRangeStart" min="0" max="23" value="9" onchange="updateCron()">
                                <span class="range-separator">-</span>
                                <input type="number" id="hourRangeEnd" min="0" max="23" value="18" onchange="updateCron()">
                            </div>
                        </div>
                        <div class="cron-field-config" id="hour-specific">
                            <label>é€‰æ‹©å°æ—¶ï¼ˆå¯å¤šé€‰ï¼‰</label>
                            <div class="checkbox-group" id="hourCheckboxes"></div>
                        </div>
                    </div>

                    <!-- æ—¥æœŸ -->
                    <div class="cron-field">
                        <div class="cron-field-header">
                            <span class="cron-field-label">æ—¥æœŸ (Day)</span>
                            <span class="cron-field-value" id="dayValue">*</span>
                        </div>
                        <div class="cron-field-type">
                            <div class="type-btn active" onclick="setFieldType('day', 'every')">æ¯å¤©</div>
                            <div class="type-btn" onclick="setFieldType('day', 'interval')">é—´éš”</div>
                            <div class="type-btn" onclick="setFieldType('day', 'range')">èŒƒå›´</div>
                            <div class="type-btn" onclick="setFieldType('day', 'specific')">æŒ‡å®š</div>
                            <div class="type-btn" onclick="setFieldType('day', 'workday')">å·¥ä½œæ—¥</div>
                            <div class="type-btn" onclick="setFieldType('day', 'last')">æœ€åä¸€å¤©</div>
                        </div>
                        <div class="cron-field-config" id="day-interval">
                            <div class="input-group">
                                <label>ä»ç¬¬å‡ å¤©å¼€å§‹ï¼ˆå¯é€‰ï¼Œç•™ç©ºè¡¨ç¤ºä»1å¼€å§‹ï¼‰</label>
                                <input type="number" id="dayIntervalStart" min="1" max="31" value="" placeholder="ç•™ç©ºè¡¨ç¤ºä»1å¼€å§‹" onchange="updateCron()">
                            </div>
                            <div class="input-group">
                                <label>æ¯éš”å¤šå°‘å¤©</label>
                                <input type="number" id="dayIntervalValue" min="1" max="31" value="1" onchange="updateCron()">
                            </div>
                        </div>
                        <div class="cron-field-config" id="day-range">
                            <label>æ—¥æœŸèŒƒå›´</label>
                            <div class="range-inputs">
                                <input type="number" id="dayRangeStart" min="1" max="31" value="1" onchange="updateCron()">
                                <span class="range-separator">-</span>
                                <input type="number" id="dayRangeEnd" min="1" max="31" value="15" onchange="updateCron()">
                            </div>
                        </div>
                        <div class="cron-field-config" id="day-specific">
                            <label>é€‰æ‹©æ—¥æœŸï¼ˆå¯å¤šé€‰ï¼‰</label>
                            <div class="checkbox-group" id="dayCheckboxes"></div>
                        </div>
                    </div>

                    <!-- æœˆä»½ -->
                    <div class="cron-field">
                        <div class="cron-field-header">
                            <span class="cron-field-label">æœˆä»½ (Month)</span>
                            <span class="cron-field-value" id="monthValue">*</span>
                        </div>
                        <div class="cron-field-type">
                            <div class="type-btn active" onclick="setFieldType('month', 'every')">æ¯æœˆ</div>
                            <div class="type-btn" onclick="setFieldType('month', 'interval')">é—´éš”</div>
                            <div class="type-btn" onclick="setFieldType('month', 'range')">èŒƒå›´</div>
                            <div class="type-btn" onclick="setFieldType('month', 'specific')">æŒ‡å®š</div>
                        </div>
                        <div class="cron-field-config" id="month-interval">
                            <div class="input-group">
                                <label>ä»ç¬¬å‡ æœˆå¼€å§‹ï¼ˆå¯é€‰ï¼Œç•™ç©ºè¡¨ç¤ºä»1æœˆå¼€å§‹ï¼‰</label>
                                <input type="number" id="monthIntervalStart" min="1" max="12" value="" placeholder="ç•™ç©ºè¡¨ç¤ºä»1æœˆå¼€å§‹" onchange="updateCron()">
                            </div>
                            <div class="input-group">
                                <label>æ¯éš”å¤šå°‘æœˆ</label>
                                <input type="number" id="monthIntervalValue" min="1" max="12" value="1" onchange="updateCron()">
                            </div>
                        </div>
                        <div class="cron-field-config" id="month-range">
                            <label>æœˆä»½èŒƒå›´</label>
                            <div class="range-inputs">
                                <input type="number" id="monthRangeStart" min="1" max="12" value="1" onchange="updateCron()">
                                <span class="range-separator">-</span>
                                <input type="number" id="monthRangeEnd" min="1" max="12" value="6" onchange="updateCron()">
                            </div>
                        </div>
                        <div class="cron-field-config" id="month-specific">
                            <label>é€‰æ‹©æœˆä»½ï¼ˆå¯å¤šé€‰ï¼‰</label>
                            <div class="checkbox-group" id="monthCheckboxes"></div>
                        </div>
                    </div>

                    <!-- æ˜ŸæœŸ -->
                    <div class="cron-field">
                        <div class="cron-field-header">
                            <span class="cron-field-label">æ˜ŸæœŸ (Week)</span>
                            <span class="cron-field-value" id="weekValue">?</span>
                        </div>
                        <div class="cron-field-type">
                            <div class="type-btn active" onclick="setFieldType('week', 'any')">ä¸æŒ‡å®š</div>
                            <div class="type-btn" onclick="setFieldType('week', 'every')">æ¯å¤©</div>
                            <div class="type-btn" onclick="setFieldType('week', 'interval')">é—´éš”</div>
                            <div class="type-btn" onclick="setFieldType('week', 'range')">èŒƒå›´</div>
                            <div class="type-btn" onclick="setFieldType('week', 'specific')">æŒ‡å®š</div>
                            <div class="type-btn" onclick="setFieldType('week', 'last')">æœ€å</div>
                        </div>
                        <div class="cron-field-config" id="week-interval">
                            <div class="input-group">
                                <label>ä»æ˜ŸæœŸå‡ å¼€å§‹ï¼ˆå¯é€‰ï¼Œç•™ç©ºè¡¨ç¤ºä»å‘¨æ—¥å¼€å§‹ï¼‰</label>
                                <select id="weekIntervalStart" onchange="updateCron()">
                                    <option value="">ç•™ç©ºï¼ˆä»å‘¨æ—¥å¼€å§‹ï¼‰</option>
                                    <option value="1">å‘¨æ—¥</option>
                                    <option value="2">å‘¨ä¸€</option>
                                    <option value="3">å‘¨äºŒ</option>
                                    <option value="4">å‘¨ä¸‰</option>
                                    <option value="5">å‘¨å››</option>
                                    <option value="6">å‘¨äº”</option>
                                    <option value="7">å‘¨å…­</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label>æ¯éš”å¤šå°‘å‘¨</label>
                                <input type="number" id="weekIntervalValue" min="1" max="7" value="1" onchange="updateCron()">
                            </div>
                        </div>
                        <div class="cron-field-config" id="week-range">
                            <label>æ˜ŸæœŸèŒƒå›´</label>
                            <div class="range-inputs">
                                <select id="weekRangeStart" onchange="updateCron()">
                                    <option value="1">å‘¨æ—¥</option>
                                    <option value="2" selected>å‘¨ä¸€</option>
                                    <option value="3">å‘¨äºŒ</option>
                                    <option value="4">å‘¨ä¸‰</option>
                                    <option value="5">å‘¨å››</option>
                                    <option value="6">å‘¨äº”</option>
                                    <option value="7">å‘¨å…­</option>
                                </select>
                                <span class="range-separator">-</span>
                                <select id="weekRangeEnd" onchange="updateCron()">
                                    <option value="1">å‘¨æ—¥</option>
                                    <option value="2">å‘¨ä¸€</option>
                                    <option value="3">å‘¨äºŒ</option>
                                    <option value="4">å‘¨ä¸‰</option>
                                    <option value="5">å‘¨å››</option>
                                    <option value="6" selected>å‘¨äº”</option>
                                    <option value="7">å‘¨å…­</option>
                                </select>
                            </div>
                        </div>
                        <div class="cron-field-config" id="week-specific">
                            <label>é€‰æ‹©æ˜ŸæœŸï¼ˆå¯å¤šé€‰ï¼‰</label>
                            <div class="checkbox-group" id="weekCheckboxes"></div>
                        </div>
                        <div class="cron-field-config" id="week-last">
                            <div class="input-group">
                                <label>é€‰æ‹©æ˜ŸæœŸ</label>
                                <select id="weekLastValue" onchange="updateCron()">
                                    <option value="1">å‘¨æ—¥</option>
                                    <option value="2">å‘¨ä¸€</option>
                                    <option value="3">å‘¨äºŒ</option>
                                    <option value="4">å‘¨ä¸‰</option>
                                    <option value="5">å‘¨å››</option>
                                    <option value="6">å‘¨äº”</option>
                                    <option value="7">å‘¨å…­</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- å¸¸ç”¨æ¨¡æ¿ -->
            <div class="section">
                <div class="section-title">ğŸ“š å¸¸ç”¨Cronè¡¨è¾¾å¼æ¨¡æ¿</div>
                <div class="templates-grid">
                    <div class="template-card" onclick="loadTemplate('everySecond', event)">
                        <div class="template-card-title">â±ï¸ æ¯ç§’æ‰§è¡Œ</div>
                        <div class="template-card-cron">* * * * * ?</div>
                        <div class="template-card-desc">æ¯ç§’æ‰§è¡Œä¸€æ¬¡ä»»åŠ¡</div>
                    </div>
                    <div class="template-card" onclick="loadTemplate('everyMinute', event)">
                        <div class="template-card-title">â° æ¯åˆ†é’Ÿæ‰§è¡Œ</div>
                        <div class="template-card-cron">0 * * * * ?</div>
                        <div class="template-card-desc">æ¯åˆ†é’Ÿæ•´ç‚¹æ‰§è¡Œ</div>
                    </div>
                    <div class="template-card" onclick="loadTemplate('everyHour', event)">
                        <div class="template-card-title">ğŸ• æ¯å°æ—¶æ‰§è¡Œ</div>
                        <div class="template-card-cron">0 0 * * * ?</div>
                        <div class="template-card-desc">æ¯å°æ—¶æ•´ç‚¹æ‰§è¡Œ</div>
                    </div>
                    <div class="template-card" onclick="loadTemplate('everyDay', event)">
                        <div class="template-card-title">ğŸ“… æ¯å¤©æ‰§è¡Œ</div>
                        <div class="template-card-cron">0 0 0 * * ?</div>
                        <div class="template-card-desc">æ¯å¤©å‡Œæ™¨0ç‚¹æ‰§è¡Œ</div>
                    </div>
                    <div class="template-card" onclick="loadTemplate('workday', event)">
                        <div class="template-card-title">ğŸ’¼ å·¥ä½œæ—¥æ‰§è¡Œ</div>
                        <div class="template-card-cron">0 0 9 ? * MON-FRI</div>
                        <div class="template-card-desc">å‘¨ä¸€è‡³å‘¨äº”ä¸Šåˆ9ç‚¹æ‰§è¡Œ</div>
                    </div>
                    <div class="template-card" onclick="loadTemplate('weekend', event)">
                        <div class="template-card-title">ğŸ‰ å‘¨æœ«æ‰§è¡Œ</div>
                        <div class="template-card-cron">0 0 10 ? * SAT,SUN</div>
                        <div class="template-card-desc">å‘¨å…­å‘¨æ—¥ä¸Šåˆ10ç‚¹æ‰§è¡Œ</div>
                    </div>
                    <div class="template-card" onclick="loadTemplate('monthly', event)">
                        <div class="template-card-title">ğŸ“† æ¯æœˆæ‰§è¡Œ</div>
                        <div class="template-card-cron">0 0 0 1 * ?</div>
                        <div class="template-card-desc">æ¯æœˆ1å·å‡Œæ™¨0ç‚¹æ‰§è¡Œ</div>
                    </div>
                    <div class="template-card" onclick="loadTemplate('quarterly', event)">
                        <div class="template-card-title">ğŸ“Š æ¯å­£åº¦æ‰§è¡Œ</div>
                        <div class="template-card-cron">0 0 0 1 1,4,7,10 ?</div>
                        <div class="template-card-desc">æ¯å­£åº¦ç¬¬ä¸€å¤©æ‰§è¡Œ</div>
                    </div>
                    <div class="template-card" onclick="loadTemplate('yearly', event)">
                        <div class="template-card-title">ğŸ† æ¯å¹´æ‰§è¡Œ</div>
                        <div class="template-card-cron">0 0 0 1 1 ?</div>
                        <div class="template-card-desc">æ¯å¹´1æœˆ1æ—¥å‡Œæ™¨0ç‚¹æ‰§è¡Œ</div>
                    </div>
                    <div class="template-card" onclick="loadTemplate('interval5m', event)">
                        <div class="template-card-title">â²ï¸ æ¯5åˆ†é’Ÿ</div>
                        <div class="template-card-cron">0 */5 * * * ?</div>
                        <div class="template-card-desc">æ¯5åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡</div>
                    </div>
                    <div class="template-card" onclick="loadTemplate('interval30m', event)">
                        <div class="template-card-title">â³ æ¯30åˆ†é’Ÿ</div>
                        <div class="template-card-cron">0 */30 * * * ?</div>
                        <div class="template-card-desc">æ¯30åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡</div>
                    </div>
                    <div class="template-card" onclick="loadTemplate('businessHours', event)">
                        <div class="template-card-title">ğŸ¢ å·¥ä½œæ—¶é—´</div>
                        <div class="template-card-cron">0 0 9-18 ? * MON-FRI</div>
                        <div class="template-card-desc">å·¥ä½œæ—¥9-18ç‚¹æ¯å°æ—¶æ‰§è¡Œ</div>
                    </div>
                </div>
            </div>

            <!-- å†å²è®°å½• -->
            <div class="history-section">
                <div class="history-header">
                    <h3>ğŸ“œ å†å²è®°å½•</h3>
                    <button class="clear-history-btn" onclick="clearHistory()">æ¸…ç©ºå†å²</button>
                </div>
                <div id="historyList" class="history-list">
                    <div class="empty-history">
                        <div>ğŸ“­</div>
                        <p>æš‚æ— å†å²è®°å½•</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const MAX_HISTORY = 20;
        const cronState = {
            second: { type: 'every', value: '*' },
            minute: { type: 'every', value: '*' },
            hour: { type: 'every', value: '*' },
            day: { type: 'every', value: '*' },
            month: { type: 'every', value: '*' },
            week: { type: 'any', value: '?' }
        };

        const weekNames = {
            '1': 'SUN', '2': 'MON', '3': 'TUE', '4': 'WED',
            '5': 'THU', '6': 'FRI', '7': 'SAT'
        };

        const weekNamesZh = {
            '1': 'å‘¨æ—¥', '2': 'å‘¨ä¸€', '3': 'å‘¨äºŒ', '4': 'å‘¨ä¸‰',
            '5': 'å‘¨å››', '6': 'å‘¨äº”', '7': 'å‘¨å…­'
        };

        // æ˜ŸæœŸåç§°åå‘æ˜ å°„
        const weekNamesReverse = {
            'SUN': '1', 'MON': '2', 'TUE': '3', 'WED': '4',
            'THU': '5', 'FRI': '6', 'SAT': '7'
        };

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initCheckboxes();
            updateCron();
            loadHistory();
            initCronDisplayInput();
        });

        // åˆå§‹åŒ–Cronè¡¨è¾¾å¼è¾“å…¥æ¡†
        function initCronDisplayInput() {
            const cronDisplay = document.getElementById('cronDisplay');
            
            // ç›‘å¬å›è½¦é”®
            cronDisplay.addEventListener('keydown', function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    parseCronInput();
                    cronDisplay.blur(); // å–æ¶ˆç„¦ç‚¹
                }
            });
            
            // ç›‘å¬å¤±å»ç„¦ç‚¹ï¼ˆå¯é€‰ï¼šè‡ªåŠ¨è§£æï¼‰
            cronDisplay.addEventListener('blur', function() {
                const currentCron = cronDisplay.textContent.trim();
                const parts = currentCron.split(/\s+/);
                // åªåœ¨æ ¼å¼æ­£ç¡®æ—¶æ‰è‡ªåŠ¨è§£æ
                if (parts.length === 6) {
                    // ä¸è‡ªåŠ¨è§£æï¼Œé¿å…å¹²æ‰°ç”¨æˆ·
                    // parseCronInput();
                }
            });
        }

        // è§£æç”¨æˆ·è¾“å…¥çš„Cronè¡¨è¾¾å¼
        function parseCronInput(event) {
            const cronDisplay = document.getElementById('cronDisplay');
            const inputCron = cronDisplay.textContent.trim();
            const button = event ? event.target : null;
            
            if (!inputCron) {
                if (button) {
                    const originalText = button.textContent;
                    const originalBg = button.style.background || '';
                    button.textContent = 'âŒ è¯·è¾“å…¥è¡¨è¾¾å¼';
                    button.style.background = '#dc3545';
                    
                    setTimeout(() => {
                        button.textContent = originalText;
                        button.style.background = originalBg;
                    }, 2000);
                }
                return;
            }
            
            const parts = inputCron.split(/\s+/);
            if (parts.length !== 6) {
                if (button) {
                    const originalText = button.textContent;
                    const originalBg = button.style.background || '';
                    button.textContent = 'âŒ æ ¼å¼é”™è¯¯';
                    button.style.background = '#dc3545';
                    
                    setTimeout(() => {
                        button.textContent = originalText;
                        button.style.background = originalBg;
                    }, 2000);
                }
                return;
            }
            
            try {
                parseCron(inputCron);
                if (button) {
                    const originalText = button.textContent;
                    const originalBg = button.style.background || '';
                    button.textContent = 'âœ… è§£ææˆåŠŸ';
                    button.style.background = '#28a745';
                    
                    setTimeout(() => {
                        button.textContent = originalText;
                        button.style.background = originalBg;
                    }, 2000);
                }
            } catch (error) {
                if (button) {
                    const originalText = button.textContent;
                    const originalBg = button.style.background || '';
                    button.textContent = 'âŒ è§£æå¤±è´¥';
                    button.style.background = '#dc3545';
                    
                    setTimeout(() => {
                        button.textContent = originalText;
                        button.style.background = originalBg;
                    }, 2000);
                }
            }
        }

        // åˆå§‹åŒ–å¤é€‰æ¡†
        function initCheckboxes() {
            // ç§’
            const secondCheckboxes = document.getElementById('secondCheckboxes');
            for (let i = 0; i < 60; i += 5) {
                secondCheckboxes.innerHTML += createCheckbox('second', i);
            }

            // åˆ†é’Ÿ
            const minuteCheckboxes = document.getElementById('minuteCheckboxes');
            for (let i = 0; i < 60; i += 5) {
                minuteCheckboxes.innerHTML += createCheckbox('minute', i);
            }

            // å°æ—¶
            const hourCheckboxes = document.getElementById('hourCheckboxes');
            for (let i = 0; i < 24; i++) {
                hourCheckboxes.innerHTML += createCheckbox('hour', i);
            }

            // æ—¥æœŸ
            const dayCheckboxes = document.getElementById('dayCheckboxes');
            for (let i = 1; i <= 31; i++) {
                dayCheckboxes.innerHTML += createCheckbox('day', i);
            }

            // æœˆä»½
            const monthCheckboxes = document.getElementById('monthCheckboxes');
            const months = ['1æœˆ', '2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ', '7æœˆ', '8æœˆ', '9æœˆ', '10æœˆ', '11æœˆ', '12æœˆ'];
            for (let i = 1; i <= 12; i++) {
                monthCheckboxes.innerHTML += createCheckbox('month', i, months[i-1]);
            }

            // æ˜ŸæœŸ
            const weekCheckboxes = document.getElementById('weekCheckboxes');
            const weeks = ['å‘¨æ—¥', 'å‘¨ä¸€', 'å‘¨äºŒ', 'å‘¨ä¸‰', 'å‘¨å››', 'å‘¨äº”', 'å‘¨å…­'];
            for (let i = 1; i <= 7; i++) {
                weekCheckboxes.innerHTML += createCheckbox('week', i, weeks[i-1]);
            }
        }

        // åˆ›å»ºå¤é€‰æ¡†
        function createCheckbox(field, value, label) {
            const displayLabel = label || value;
            return `
                <div class="checkbox-item" onclick="toggleCheckbox(this, '${field}')">
                    <input type="checkbox" value="${value}" onchange="updateCron()">
                    <label>${displayLabel}</label>
                </div>
            `;
        }

        // åˆ‡æ¢å¤é€‰æ¡†
        function toggleCheckbox(element, field) {
            const checkbox = element.querySelector('input[type="checkbox"]');
            checkbox.checked = !checkbox.checked;
            element.classList.toggle('checked', checkbox.checked);
            updateCron();
        }

        // è®¾ç½®å­—æ®µç±»å‹
        function setFieldType(field, type) {
            cronState[field].type = type;

            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            const fieldElement = event.target.closest('.cron-field');
            fieldElement.querySelectorAll('.type-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            // éšè—æ‰€æœ‰é…ç½®
            fieldElement.querySelectorAll('.cron-field-config').forEach(config => {
                config.classList.remove('active');
            });

            // æ˜¾ç¤ºå¯¹åº”é…ç½®
            if (type !== 'every' && type !== 'any' && type !== 'workday' && type !== 'last') {
                const configElement = document.getElementById(`${field}-${type}`);
                if (configElement) {
                    configElement.classList.add('active');
                }
            }

            // å¦‚æœé€‰æ‹©äº†dayçš„éanyç±»å‹ï¼Œweekè‡ªåŠ¨è®¾ä¸º?
            if (field === 'day' && type !== 'every' && type !== 'any') {
                cronState.week.value = '?';
                document.getElementById('weekValue').textContent = '?';
            }

            // å¦‚æœé€‰æ‹©äº†weekçš„éanyç±»å‹ï¼Œdayè‡ªåŠ¨è®¾ä¸º?
            if (field === 'week' && type !== 'any' && type !== 'every') {
                cronState.day.value = '?';
                document.getElementById('dayValue').textContent = '?';
            }

            updateCron();
        }

        // æ›´æ–°Cronè¡¨è¾¾å¼
        function updateCron() {
            // æ›´æ–°å„å­—æ®µçš„å€¼
            updateFieldValue('second');
            updateFieldValue('minute');
            updateFieldValue('hour');
            updateFieldValue('day');
            updateFieldValue('month');
            updateFieldValue('week');

            // ç”Ÿæˆå®Œæ•´çš„cronè¡¨è¾¾å¼
            const cron = `${cronState.second.value} ${cronState.minute.value} ${cronState.hour.value} ${cronState.day.value} ${cronState.month.value} ${cronState.week.value}`;
            document.getElementById('cronDisplay').textContent = cron;

            // æ›´æ–°æè¿°å’Œä¸‹æ¬¡æ‰§è¡Œæ—¶é—´
            updateDescription(cron);
            updateNextRuns(cron);
        }

        // æ›´æ–°å­—æ®µå€¼
        function updateFieldValue(field) {
            const state = cronState[field];
            let value = '*';

            switch (state.type) {
                case 'every':
                    value = '*';
                    break;
                case 'any':
                    value = '?';
                    break;
                case 'interval':
                    const intervalStart = document.getElementById(`${field}IntervalStart`);
                    const intervalValue = document.getElementById(`${field}IntervalValue`).value;
                    
                    // å¦‚æœæœ‰èµ·å§‹å€¼ï¼Œä½¿ç”¨ X/Y æ ¼å¼ï¼Œå¦åˆ™ä½¿ç”¨ */Y æ ¼å¼
                    if (intervalStart && intervalStart.value) {
                        value = `${intervalStart.value}/${intervalValue}`;
                    } else {
                        value = `*/${intervalValue}`;
                    }
                    break;
                case 'range':
                    const rangeStart = document.getElementById(`${field}RangeStart`).value;
                    const rangeEnd = document.getElementById(`${field}RangeEnd`).value;
                    value = `${rangeStart}-${rangeEnd}`;
                    break;
                case 'specific':
                    const checkboxes = document.querySelectorAll(`#${field}Checkboxes input[type="checkbox"]:checked`);
                    const values = Array.from(checkboxes).map(cb => {
                        if (field === 'week') {
                            return weekNames[cb.value];
                        }
                        return cb.value;
                    });
                    value = values.length > 0 ? values.join(',') : '*';
                    break;
                case 'workday':
                    value = 'W';
                    break;
                case 'last':
                    if (field === 'day') {
                        value = 'L';
                    } else if (field === 'week') {
                        const lastWeek = document.getElementById('weekLastValue').value;
                        value = weekNames[lastWeek] + 'L';
                    }
                    break;
            }

            state.value = value;
            document.getElementById(`${field}Value`).textContent = value;
        }

        // æ›´æ–°æè¿°
        function updateDescription(cron) {
            const parts = cron.split(' ');
            const desc = [];

            // è§£æç§’
            if (parts[0] === '*') {
                desc.push('æ¯ç§’');
            } else if (parts[0].includes('/')) {
                const [base, interval] = parts[0].split('/');
                if (base === '*') {
                    desc.push(`æ¯${interval}ç§’`);
                } else {
                    desc.push(`ä»ç¬¬${base}ç§’å¼€å§‹æ¯${interval}ç§’`);
                }
            } else if (parts[0].includes('-')) {
                const [start, end] = parts[0].split('-');
                desc.push(`ç¬¬${start}-${end}ç§’`);
            } else if (parts[0] !== '0' && parts[0] !== '?') {
                desc.push(`ç¬¬${parts[0]}ç§’`);
            }

            // è§£æåˆ†é’Ÿ
            if (parts[1] === '*') {
                desc.push('æ¯åˆ†é’Ÿ');
            } else if (parts[1].includes('/')) {
                const [base, interval] = parts[1].split('/');
                if (base === '*') {
                    desc.push(`æ¯${interval}åˆ†é’Ÿ`);
                } else {
                    desc.push(`ä»ç¬¬${base}åˆ†é’Ÿå¼€å§‹æ¯${interval}åˆ†é’Ÿ`);
                }
            } else if (parts[1].includes('-')) {
                const [start, end] = parts[1].split('-');
                desc.push(`ç¬¬${start}-${end}åˆ†é’Ÿ`);
            } else if (parts[1] !== '0' && parts[1] !== '?') {
                desc.push(`ç¬¬${parts[1]}åˆ†é’Ÿ`);
            }

            // è§£æå°æ—¶
            if (parts[2] === '*') {
                desc.push('æ¯å°æ—¶');
            } else if (parts[2].includes('/')) {
                const [base, interval] = parts[2].split('/');
                if (base === '*') {
                    desc.push(`æ¯${interval}å°æ—¶`);
                } else {
                    desc.push(`ä»${base}ç‚¹å¼€å§‹æ¯${interval}å°æ—¶`);
                }
            } else if (parts[2].includes('-')) {
                const [start, end] = parts[2].split('-');
                desc.push(`${start}-${end}ç‚¹`);
            } else if (parts[2] !== '0' && parts[2] !== '?') {
                desc.push(`${parts[2]}ç‚¹`);
            }

            // è§£ææ—¥æœŸ
            if (parts[3] === '*') {
                desc.push('æ¯å¤©');
            } else if (parts[3] === '?') {
                // ä¸æŒ‡å®š
            } else if (parts[3] === 'L') {
                desc.push('æ¯æœˆæœ€åä¸€å¤©');
            } else if (parts[3] === 'W') {
                desc.push('å·¥ä½œæ—¥');
            } else if (parts[3].includes('/')) {
                const [base, interval] = parts[3].split('/');
                if (base === '*') {
                    desc.push(`æ¯${interval}å¤©`);
                } else {
                    desc.push(`ä»${base}å·å¼€å§‹æ¯${interval}å¤©`);
                }
            } else if (parts[3].includes('-')) {
                const [start, end] = parts[3].split('-');
                desc.push(`${start}-${end}å·`);
            } else {
                desc.push(`${parts[3]}å·`);
            }

            // è§£ææœˆä»½
            if (parts[4] === '*') {
                desc.push('æ¯æœˆ');
            } else if (parts[4].includes('/')) {
                const [base, interval] = parts[4].split('/');
                if (base === '*') {
                    desc.push(`æ¯${interval}ä¸ªæœˆ`);
                } else {
                    desc.push(`ä»${base}æœˆå¼€å§‹æ¯${interval}ä¸ªæœˆ`);
                }
            } else if (parts[4].includes('-')) {
                const [start, end] = parts[4].split('-');
                desc.push(`${start}-${end}æœˆ`);
            } else if (parts[4] !== '?') {
                desc.push(`${parts[4]}æœˆ`);
            }

            // è§£ææ˜ŸæœŸ
            if (parts[5] === '*') {
                desc.push('æ¯å‘¨');
            } else if (parts[5] === '?') {
                // ä¸æŒ‡å®š
            } else if (parts[5].includes('L')) {
                const day = parts[5].replace('L', '');
                const weekMap = { 'SUN': 'å‘¨æ—¥', 'MON': 'å‘¨ä¸€', 'TUE': 'å‘¨äºŒ', 'WED': 'å‘¨ä¸‰', 'THU': 'å‘¨å››', 'FRI': 'å‘¨äº”', 'SAT': 'å‘¨å…­' };
                desc.push(`æ¯æœˆæœ€åä¸€ä¸ª${weekMap[day] || day}`);
            } else if (parts[5].includes('-')) {
                const [start, end] = parts[5].split('-');
                const weekMap = { 'SUN': 'å‘¨æ—¥', 'MON': 'å‘¨ä¸€', 'TUE': 'å‘¨äºŒ', 'WED': 'å‘¨ä¸‰', 'THU': 'å‘¨å››', 'FRI': 'å‘¨äº”', 'SAT': 'å‘¨å…­' };
                desc.push(`${weekMap[start] || start}è‡³${weekMap[end] || end}`);
            } else if (parts[5].includes(',')) {
                const days = parts[5].split(',');
                const weekMap = { 'SUN': 'å‘¨æ—¥', 'MON': 'å‘¨ä¸€', 'TUE': 'å‘¨äºŒ', 'WED': 'å‘¨ä¸‰', 'THU': 'å‘¨å››', 'FRI': 'å‘¨äº”', 'SAT': 'å‘¨å…­' };
                const daysText = days.map(d => weekMap[d] || d).join('ã€');
                desc.push(daysText);
            } else if (parts[5] !== '?') {
                const weekMap = { 'SUN': 'å‘¨æ—¥', 'MON': 'å‘¨ä¸€', 'TUE': 'å‘¨äºŒ', 'WED': 'å‘¨ä¸‰', 'THU': 'å‘¨å››', 'FRI': 'å‘¨äº”', 'SAT': 'å‘¨å…­' };
                desc.push(weekMap[parts[5]] || parts[5]);
            }

            let description = desc.join(' ');
            if (description === '') {
                description = 'è‡ªå®šä¹‰Cronè¡¨è¾¾å¼';
            } else {
                description += ' æ‰§è¡Œ';
            }

            document.getElementById('cronDescription').textContent = description;
        }

        // è®¡ç®—ä¸‹æ¬¡æ‰§è¡Œæ—¶é—´ï¼ˆæ”¹è¿›ç‰ˆï¼‰
        function updateNextRuns(cron) {
            const nextRunsList = document.getElementById('nextRunsList');
            const runs = [];
            
            try {
                const now = new Date();
                let current = new Date(now.getTime());
                
                for (let i = 0; i < 5 && runs.length < 5; i++) {
                    current = getNextRun(cron, current);
                    if (current) {
                        runs.push(formatDateTime(current));
                        current = new Date(current.getTime() + 1000);
                    } else {
                        break;
                    }
                }
            } catch (e) {
                console.error('è®¡ç®—æ‰§è¡Œæ—¶é—´å‡ºé”™:', e);
                runs.push('æ— æ³•è®¡ç®—æ‰§è¡Œæ—¶é—´');
            }

            if (runs.length === 0) {
                nextRunsList.innerHTML = '<div class="next-run-item">âš ï¸ æ— æ³•è®¡ç®—ä¸‹æ¬¡æ‰§è¡Œæ—¶é—´</div>';
            } else {
                nextRunsList.innerHTML = runs.map((run, idx) => 
                    `<div class="next-run-item">â° ç¬¬${idx + 1}æ¬¡: ${run}</div>`
                ).join('');
            }
        }

        // æ”¹è¿›çš„ä¸‹æ¬¡è¿è¡Œæ—¶é—´è®¡ç®—
        function getNextRun(cron, from) {
            const parts = cron.split(' ');
            const current = new Date(from.getTime());
            
            // å‘å‰æ¨è¿›åˆ°ä¸‹ä¸€ç§’
            current.setSeconds(current.getSeconds() + 1);
            current.setMilliseconds(0);

            // è·å–æ¯ä¸ªå­—æ®µçš„å¯èƒ½å€¼
            const secondValues = getPossibleValues(parts[0], 0, 59);
            const minuteValues = getPossibleValues(parts[1], 0, 59);
            const hourValues = getPossibleValues(parts[2], 0, 23);
            const monthValues = getPossibleValues(parts[4], 1, 12);

            // æœ€å¤šå‘å‰æœç´¢2å¹´
            const maxDate = new Date(current.getTime() + 2 * 365 * 24 * 60 * 60 * 1000);
            let iterations = 0;
            const maxIterations = 100000;

            while (current < maxDate && iterations < maxIterations) {
                iterations++;
                
                if (matchesCron(current, parts)) {
                    return new Date(current.getTime());
                }
                
                // æ™ºèƒ½æ¨è¿›ï¼šè·³åˆ°ä¸‹ä¸€ä¸ªå¯èƒ½çš„æ—¶é—´ç‚¹
                if (!secondValues.includes(current.getSeconds())) {
                    // ç§’ä¸åŒ¹é…ï¼Œè·³åˆ°ä¸‹ä¸€ä¸ªåŒ¹é…çš„ç§’
                    const nextSecond = findNextValue(current.getSeconds(), secondValues, 60);
                    if (nextSecond > current.getSeconds()) {
                        current.setSeconds(nextSecond);
                    } else {
                        current.setMinutes(current.getMinutes() + 1);
                        current.setSeconds(nextSecond);
                    }
                    continue;
                }
                
                if (!minuteValues.includes(current.getMinutes())) {
                    // åˆ†é’Ÿä¸åŒ¹é…ï¼Œè·³åˆ°ä¸‹ä¸€ä¸ªåŒ¹é…çš„åˆ†é’Ÿ
                    const nextMinute = findNextValue(current.getMinutes(), minuteValues, 60);
                    if (nextMinute > current.getMinutes()) {
                        current.setMinutes(nextMinute);
                        current.setSeconds(secondValues[0]);
                    } else {
                        current.setHours(current.getHours() + 1);
                        current.setMinutes(nextMinute);
                        current.setSeconds(secondValues[0]);
                    }
                    continue;
                }
                
                if (!hourValues.includes(current.getHours())) {
                    // å°æ—¶ä¸åŒ¹é…ï¼Œè·³åˆ°ä¸‹ä¸€ä¸ªåŒ¹é…çš„å°æ—¶
                    const nextHour = findNextValue(current.getHours(), hourValues, 24);
                    if (nextHour > current.getHours()) {
                        current.setHours(nextHour);
                        current.setMinutes(minuteValues[0]);
                        current.setSeconds(secondValues[0]);
                    } else {
                        current.setDate(current.getDate() + 1);
                        current.setHours(nextHour);
                        current.setMinutes(minuteValues[0]);
                        current.setSeconds(secondValues[0]);
                    }
                    continue;
                }
                
                if (!monthValues.includes(current.getMonth() + 1)) {
                    // æœˆä»½ä¸åŒ¹é…ï¼Œè·³åˆ°ä¸‹ä¸€ä¸ªåŒ¹é…çš„æœˆä»½
                    const nextMonth = findNextValue(current.getMonth() + 1, monthValues, 13);
                    if (nextMonth > current.getMonth() + 1) {
                        current.setMonth(nextMonth - 1);
                        current.setDate(1);
                        current.setHours(hourValues[0]);
                        current.setMinutes(minuteValues[0]);
                        current.setSeconds(secondValues[0]);
                    } else {
                        current.setFullYear(current.getFullYear() + 1);
                        current.setMonth(nextMonth - 1);
                        current.setDate(1);
                        current.setHours(hourValues[0]);
                        current.setMinutes(minuteValues[0]);
                        current.setSeconds(secondValues[0]);
                    }
                    continue;
                }
                
                // å¦‚æœæ‰€æœ‰å­—æ®µéƒ½åŒ¹é…ä½†æ•´ä½“ä¸åŒ¹é…ï¼Œæ¨è¿›ä¸€ç§’
                current.setSeconds(current.getSeconds() + 1);
            }
            
            return null;
        }

        // è·å–å­—æ®µçš„æ‰€æœ‰å¯èƒ½å€¼
        function getPossibleValues(pattern, min, max) {
            if (pattern === '*' || pattern === '?') {
                const values = [];
                for (let i = min; i <= max; i++) {
                    values.push(i);
                }
                return values;
            }

            // å¤„ç†é—´éš” */n æˆ– n/m
            if (pattern.includes('/')) {
                const [base, interval] = pattern.split('/');
                const intervalNum = parseInt(interval);
                const values = [];
                
                if (base === '*') {
                    // */n è¡¨ç¤ºä»minå¼€å§‹æ¯éš”n
                    for (let i = min; i <= max; i += intervalNum) {
                        values.push(i);
                    }
                } else {
                    // n/m è¡¨ç¤ºä»nå¼€å§‹æ¯éš”m
                    const startNum = parseInt(base);
                    for (let i = startNum; i <= max; i += intervalNum) {
                        values.push(i);
                    }
                }
                
                return values;
            }

            // å¤„ç†èŒƒå›´ n-m
            if (pattern.includes('-') && !pattern.includes(',')) {
                const [start, end] = pattern.split('-').map(Number);
                const values = [];
                for (let i = start; i <= end; i++) {
                    values.push(i);
                }
                return values;
            }

            // å¤„ç†åˆ—è¡¨ n,m,o
            if (pattern.includes(',')) {
                return pattern.split(',').map(v => {
                    if (isNaN(v)) return 0;
                    return parseInt(v);
                }).filter(v => v >= min && v <= max);
            }

            // å¤„ç†å…·ä½“å€¼
            const value = parseInt(pattern);
            if (!isNaN(value) && value >= min && value <= max) {
                return [value];
            }

            // å…¶ä»–æƒ…å†µè¿”å›æ‰€æœ‰å¯èƒ½å€¼
            const values = [];
            for (let i = min; i <= max; i++) {
                values.push(i);
            }
            return values;
        }

        // æŸ¥æ‰¾ä¸‹ä¸€ä¸ªåŒ¹é…çš„å€¼
        function findNextValue(current, possibleValues, max) {
            for (let value of possibleValues) {
                if (value > current) {
                    return value;
                }
            }
            // å¦‚æœæ²¡æœ‰æ›´å¤§çš„å€¼ï¼Œè¿”å›ç¬¬ä¸€ä¸ªå€¼ï¼ˆè¡¨ç¤ºéœ€è¦è¿›ä½ï¼‰
            return possibleValues[0];
        }

        // æ£€æŸ¥æ—¶é—´æ˜¯å¦åŒ¹é…cronè¡¨è¾¾å¼
        function matchesCron(date, parts) {
            const second = date.getSeconds();
            const minute = date.getMinutes();
            const hour = date.getHours();
            const day = date.getDate();
            const month = date.getMonth() + 1;
            const dayOfWeek = date.getDay() + 1; // JavaScript: 0=Sunday, Cron: 1=Sunday

            // æ£€æŸ¥ç§’ã€åˆ†ã€æ—¶ã€æœˆ
            if (!matchesPart(second, parts[0], 0, 59)) return false;
            if (!matchesPart(minute, parts[1], 0, 59)) return false;
            if (!matchesPart(hour, parts[2], 0, 23)) return false;
            if (!matchesPart(month, parts[4], 1, 12)) return false;

            // æ—¥æœŸå’Œæ˜ŸæœŸçš„å¤„ç†æ¯”è¾ƒç‰¹æ®Š
            // åœ¨Quartzä¸­ï¼Œå½“dayå’Œweekéƒ½ä¸æ˜¯?æ—¶ï¼Œæ»¡è¶³å…¶ä¸­ä¸€ä¸ªå³å¯ï¼ˆORå…³ç³»ï¼‰
            // å½“å…¶ä¸­ä¸€ä¸ªæ˜¯?æ—¶ï¼Œåªæ£€æŸ¥å¦ä¸€ä¸ª
            const dayPattern = parts[3];
            const weekPattern = parts[5];

            if (dayPattern === '?' && weekPattern === '?') {
                // ä¸¤ä¸ªéƒ½æ˜¯?ï¼Œä»»ä½•æ—¥æœŸéƒ½åŒ¹é…
                return true;
            } else if (dayPattern === '?') {
                // åªæ£€æŸ¥æ˜ŸæœŸ
                return matchesWeekPart(dayOfWeek, weekPattern, date);
            } else if (weekPattern === '?') {
                // åªæ£€æŸ¥æ—¥æœŸ
                return matchesDayPart(date, dayPattern);
            } else {
                // ä¸¤ä¸ªéƒ½æœ‰æŒ‡å®šå€¼ï¼Œæ»¡è¶³å…¶ä¸­ä¸€ä¸ªå³å¯ï¼ˆORå…³ç³»ï¼‰
                return matchesDayPart(date, dayPattern) || matchesWeekPart(dayOfWeek, weekPattern, date);
            }
        }

        // åŒ¹é…æ—¥æœŸå­—æ®µï¼ˆæ”¯æŒç‰¹æ®Šå­—ç¬¦ï¼‰
        function matchesDayPart(date, pattern) {
            const day = date.getDate();
            
            if (pattern === '*' || pattern === '?') return true;
            
            // L - æœ€åä¸€å¤©
            if (pattern === 'L') {
                const lastDay = getLastDayOfMonth(date);
                return day === lastDay;
            }
            
            // W - æœ€è¿‘çš„å·¥ä½œæ—¥
            if (pattern === 'W') {
                return isWeekday(date);
            }
            
            // LW - æœ€åä¸€ä¸ªå·¥ä½œæ—¥
            if (pattern === 'LW') {
                const lastDay = getLastDayOfMonth(date);
                const lastDate = new Date(date.getFullYear(), date.getMonth(), lastDay);
                const lastWeekday = getLastWeekdayOfMonth(date);
                return day === lastWeekday;
            }
            
            // nW - æœ€æ¥è¿‘nå·çš„å·¥ä½œæ—¥
            if (pattern.includes('W')) {
                const targetDay = parseInt(pattern.replace('W', ''));
                const nearestWeekday = getNearestWeekday(date.getFullYear(), date.getMonth(), targetDay);
                return day === nearestWeekday;
            }
            
            return matchesPart(day, pattern, 1, 31);
        }

        // åˆ¤æ–­æ˜¯å¦æ˜¯å·¥ä½œæ—¥
        function isWeekday(date) {
            const dayOfWeek = date.getDay(); // 0=Sunday, 6=Saturday
            return dayOfWeek >= 1 && dayOfWeek <= 5;
        }

        // è·å–æœˆä»½æœ€åä¸€å¤©
        function getLastDayOfMonth(date) {
            const nextMonth = new Date(date.getFullYear(), date.getMonth() + 1, 0);
            return nextMonth.getDate();
        }

        // è·å–æœˆä»½æœ€åä¸€ä¸ªå·¥ä½œæ—¥
        function getLastWeekdayOfMonth(date) {
            const lastDay = getLastDayOfMonth(date);
            let lastDate = new Date(date.getFullYear(), date.getMonth(), lastDay);
            
            while (!isWeekday(lastDate)) {
                lastDate.setDate(lastDate.getDate() - 1);
            }
            
            return lastDate.getDate();
        }

        // è·å–æœ€æ¥è¿‘æŒ‡å®šæ—¥æœŸçš„å·¥ä½œæ—¥
        function getNearestWeekday(year, month, day) {
            let targetDate = new Date(year, month, day);
            
            // å¦‚æœç›®æ ‡æ—¥æœŸå°±æ˜¯å·¥ä½œæ—¥ï¼Œç›´æ¥è¿”å›
            if (isWeekday(targetDate)) {
                return day;
            }
            
            // å¦‚æœæ˜¯å‘¨å…­ï¼Œæ‰¾å‰ä¸€ä¸ªå·¥ä½œæ—¥ï¼ˆé™¤éæ˜¯1å·ï¼‰
            if (targetDate.getDay() === 6) {
                if (day === 1) {
                    return 3; // å‘¨ä¸€
                }
                return day - 1;
            }
            
            // å¦‚æœæ˜¯å‘¨æ—¥ï¼Œæ‰¾åä¸€ä¸ªå·¥ä½œæ—¥ï¼ˆé™¤éæ˜¯æœˆæœ«ï¼‰
            if (targetDate.getDay() === 0) {
                const lastDay = getLastDayOfMonth(targetDate);
                if (day === lastDay) {
                    return day - 2; // å‘¨äº”
                }
                return day + 1;
            }
            
            return day;
        }

        // åŒ¹é…å•ä¸ªå­—æ®µ
        function matchesPart(value, pattern, min, max) {
            if (pattern === '*' || pattern === '?') return true;

            // å¤„ç†é—´éš” */n æˆ– n/m
            if (pattern.includes('/')) {
                const [base, interval] = pattern.split('/');
                const intervalNum = parseInt(interval);
                
                if (base === '*') {
                    // */n è¡¨ç¤ºä»minå¼€å§‹æ¯éš”n
                    return (value - min) % intervalNum === 0;
                } else {
                    // n/m è¡¨ç¤ºä»nå¼€å§‹æ¯éš”m
                    const startNum = parseInt(base);
                    if (value < startNum) return false;
                    return (value - startNum) % intervalNum === 0;
                }
            }

            // å¤„ç†èŒƒå›´ n-m
            if (pattern.includes('-') && !pattern.includes(',')) {
                const [start, end] = pattern.split('-').map(Number);
                return value >= start && value <= end;
            }

            // å¤„ç†åˆ—è¡¨ n,m,o
            if (pattern.includes(',')) {
                const values = pattern.split(',').map(Number);
                return values.includes(value);
            }

            // å¤„ç†å…·ä½“å€¼
            const num = parseInt(pattern);
            if (!isNaN(num)) {
                return value === num;
            }
            
            return false;
        }

        // åŒ¹é…æ˜ŸæœŸå­—æ®µ
        function matchesWeekPart(dayOfWeek, pattern, date) {
            if (pattern === '*' || pattern === '?') return true;

            // è½¬æ¢æ˜ŸæœŸåç§°
            const weekMap = { 'SUN': 1, 'MON': 2, 'TUE': 3, 'WED': 4, 'THU': 5, 'FRI': 6, 'SAT': 7 };
            
            // å¤„ç†"æœ€åä¸€ä¸ªæ˜ŸæœŸX"ï¼ˆå¦‚MONLè¡¨ç¤ºæœ€åä¸€ä¸ªå‘¨ä¸€ï¼‰
            if (pattern.includes('L')) {
                const weekDay = pattern.replace('L', '');
                const targetWeekNum = weekMap[weekDay] || parseInt(weekDay);
                
                // æ£€æŸ¥å½“å‰æ—¥æœŸæ˜¯å¦æ˜¯è¯¥æœˆæœ€åä¸€ä¸ªæŒ‡å®šæ˜ŸæœŸ
                if (dayOfWeek !== targetWeekNum) {
                    return false;
                }
                
                // æ£€æŸ¥æ˜¯å¦æ˜¯æœ€åä¸€ä¸ª
                const currentDate = date || new Date();
                const nextWeek = new Date(currentDate);
                nextWeek.setDate(nextWeek.getDate() + 7);
                
                // å¦‚æœåŠ 7å¤©åè¿˜åœ¨åŒä¸€ä¸ªæœˆï¼Œè¯´æ˜ä¸æ˜¯æœ€åä¸€ä¸ª
                return nextWeek.getMonth() !== currentDate.getMonth();
            }
            
            // å¤„ç†èŒƒå›´ MON-FRI
            if (pattern.includes('-') && !pattern.includes(',')) {
                const [start, end] = pattern.split('-');
                const startNum = weekMap[start] || parseInt(start);
                const endNum = weekMap[end] || parseInt(end);
                return dayOfWeek >= startNum && dayOfWeek <= endNum;
            }

            // å¤„ç†åˆ—è¡¨ MON,WED,FRI
            if (pattern.includes(',')) {
                const values = pattern.split(',').map(v => weekMap[v] || parseInt(v));
                return values.includes(dayOfWeek);
            }

            // å¤„ç†å…·ä½“å€¼
            const patternNum = weekMap[pattern] || parseInt(pattern);
            return dayOfWeek === patternNum;
        }

        // æ ¼å¼åŒ–æ—¥æœŸæ—¶é—´
        function formatDateTime(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            const hour = String(date.getHours()).padStart(2, '0');
            const minute = String(date.getMinutes()).padStart(2, '0');
            const second = String(date.getSeconds()).padStart(2, '0');
            const weekDay = ['å‘¨æ—¥', 'å‘¨ä¸€', 'å‘¨äºŒ', 'å‘¨ä¸‰', 'å‘¨å››', 'å‘¨äº”', 'å‘¨å…­'][date.getDay()];
            
            return `${year}-${month}-${day} ${hour}:${minute}:${second} ${weekDay}`;
        }

        // å¤åˆ¶Cronè¡¨è¾¾å¼
        function copyCron(event) {
            const cronText = document.getElementById('cronDisplay').textContent;
            const button = event ? event.target : null;
            
            navigator.clipboard.writeText(cronText).then(() => {
                if (button) {
                    const originalText = button.textContent;
                    const originalBg = button.style.background || '';
                    button.textContent = 'âœ… å·²å¤åˆ¶';
                    button.style.background = '#28a745';
                    
                    setTimeout(() => {
                        button.textContent = originalText;
                        button.style.background = originalBg;
                    }, 2000);
                }
            }).catch(() => {
                if (button) {
                    const originalText = button.textContent;
                    const originalBg = button.style.background || '';
                    button.textContent = 'âŒ å¤åˆ¶å¤±è´¥';
                    button.style.background = '#dc3545';
                    
                    setTimeout(() => {
                        button.textContent = originalText;
                        button.style.background = originalBg;
                    }, 2000);
                }
            });
        }

        // ä¿å­˜åˆ°å†å²
        function saveCron(event) {
            const cron = document.getElementById('cronDisplay').textContent;
            const desc = document.getElementById('cronDescription').textContent;
            const button = event ? event.target : null;
            
            const history = getHistory();
            const record = {
                id: Date.now(),
                cron: cron,
                description: desc,
                timestamp: new Date().toLocaleString('zh-CN')
            };

            history.unshift(record);

            if (history.length > MAX_HISTORY) {
                history.pop();
            }

            localStorage.setItem('cron_history', JSON.stringify(history));
            loadHistory();
            
            if (button) {
                const originalText = button.textContent;
                const originalBg = button.style.background || '';
                button.textContent = 'âœ… å·²ä¿å­˜';
                button.style.background = '#28a745';
                
                setTimeout(() => {
                    button.textContent = originalText;
                    button.style.background = originalBg;
                }, 2000);
            }
        }

        // é‡ç½®æ‰€æœ‰
        function resetAll() {
            // ç›´æ¥é‡ç½®ï¼Œä¸æ˜¾ç¤ºç¡®è®¤æç¤º
            // é‡ç½®çŠ¶æ€
            cronState.second = { type: 'every', value: '*' };
            cronState.minute = { type: 'every', value: '*' };
            cronState.hour = { type: 'every', value: '*' };
            cronState.day = { type: 'every', value: '*' };
            cronState.month = { type: 'every', value: '*' };
            cronState.week = { type: 'any', value: '?' };

            // é‡ç½®UI
            document.querySelectorAll('.type-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.cron-field').forEach((field, idx) => {
                const firstBtn = field.querySelector('.type-btn');
                if (firstBtn) firstBtn.classList.add('active');
            });
            document.querySelectorAll('.cron-field-config').forEach(config => {
                config.classList.remove('active');
            });
            document.querySelectorAll('.checkbox-item').forEach(item => {
                item.classList.remove('checked');
                item.querySelector('input[type="checkbox"]').checked = false;
            });

            updateCron();
        }

        // åŠ è½½æ¨¡æ¿
        function loadTemplate(templateName, event) {
            const templates = {
                everySecond: { cron: '* * * * * ?' },
                everyMinute: { cron: '0 * * * * ?' },
                everyHour: { cron: '0 0 * * * ?' },
                everyDay: { cron: '0 0 0 * * ?' },
                workday: { cron: '0 0 9 ? * MON-FRI' },
                weekend: { cron: '0 0 10 ? * SAT,SUN' },
                monthly: { cron: '0 0 0 1 * ?' },
                quarterly: { cron: '0 0 0 1 1,4,7,10 ?' },
                yearly: { cron: '0 0 0 1 1 ?' },
                interval5m: { cron: '0 */5 * * * ?' },
                interval30m: { cron: '0 */30 * * * ?' },
                businessHours: { cron: '0 0 9-18 ? * MON-FRI' }
            };

            const template = templates[templateName];
            if (template) {
                parseCron(template.cron);
                
                // æ˜¾ç¤ºå¡ç‰‡åé¦ˆæ•ˆæœ
                if (event) {
                    const card = event.currentTarget || event.target.closest('.template-card');
                    if (card) {
                        const originalBg = card.style.background || '';
                        card.style.background = '#d4edda';
                        card.style.borderColor = '#28a745';
                        
                        setTimeout(() => {
                            card.style.background = originalBg;
                            card.style.borderColor = '';
                        }, 500);
                    }
                }
            }
        }

        // è§£æCronè¡¨è¾¾å¼ï¼ˆå®Œæ•´ç‰ˆï¼‰
        function parseCron(cron) {
            const parts = cron.trim().split(/\s+/);
            if (parts.length !== 6) {
                // é™é»˜å¤±è´¥ï¼Œä¸æ˜¾ç¤ºæç¤º
                return;
            }

            // å…ˆé‡ç½®æ‰€æœ‰çŠ¶æ€
            resetAllState();

            // è§£ææ¯ä¸ªå­—æ®µ
            parseField('second', parts[0], 0, 59);
            parseField('minute', parts[1], 0, 59);
            parseField('hour', parts[2], 0, 23);
            parseField('day', parts[3], 1, 31);
            parseField('month', parts[4], 1, 12);
            parseField('week', parts[5], 1, 7);

            // æ›´æ–°æ˜¾ç¤º
            updateCron();
            
            // æ»šåŠ¨åˆ°é¡¶éƒ¨
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // é‡ç½®æ‰€æœ‰çŠ¶æ€ï¼ˆä¸å¼¹å‡ºç¡®è®¤ï¼‰
        function resetAllState() {
            // é‡ç½®çŠ¶æ€
            cronState.second = { type: 'every', value: '*' };
            cronState.minute = { type: 'every', value: '*' };
            cronState.hour = { type: 'every', value: '*' };
            cronState.day = { type: 'every', value: '*' };
            cronState.month = { type: 'every', value: '*' };
            cronState.week = { type: 'any', value: '?' };

            // é‡ç½®UI
            document.querySelectorAll('.type-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.cron-field-config').forEach(config => {
                config.classList.remove('active');
            });
            document.querySelectorAll('.checkbox-item').forEach(item => {
                item.classList.remove('checked');
                item.querySelector('input[type="checkbox"]').checked = false;
            });
        }

        // è§£æå•ä¸ªå­—æ®µ
        function parseField(field, value, min, max) {
            if (value === '*') {
                // æ¯...ï¼ˆä½†weekå­—æ®µçš„*è¡¨ç¤ºæ¯å¤©ï¼‰
                if (field === 'week') {
                    setFieldTypeProgram(field, 'every');
                } else {
                    setFieldTypeProgram(field, 'every');
                }
            } else if (value === '?') {
                // ä¸æŒ‡å®š
                setFieldTypeProgram(field, 'any');
            } else if (value === 'L') {
                // æœ€åä¸€å¤©
                setFieldTypeProgram(field, 'last');
            } else if (value === 'W') {
                // å·¥ä½œæ—¥
                setFieldTypeProgram(field, 'workday');
            } else if (value.includes('L')) {
                // æœ€åä¸€ä¸ªæ˜ŸæœŸX
                setFieldTypeProgram(field, 'last');
                const weekDay = value.replace('L', '');
                const weekNum = weekNamesReverse[weekDay];
                if (weekNum && document.getElementById('weekLastValue')) {
                    document.getElementById('weekLastValue').value = weekNum;
                }
            } else if (value.includes('/')) {
                // é—´éš”ï¼šæ”¯æŒ */n å’Œ x/n ä¸¤ç§æ ¼å¼
                const parts = value.split('/');
                const base = parts[0];
                const interval = parts[1];
                
                setFieldTypeProgram(field, 'interval');
                
                // è®¾ç½®é—´éš”å€¼
                const inputElement = document.getElementById(`${field}IntervalValue`);
                if (inputElement) {
                    inputElement.value = interval;
                }
                
                // è®¾ç½®èµ·å§‹å€¼ï¼ˆå¦‚æœä¸æ˜¯*çš„è¯ï¼‰
                const startElement = document.getElementById(`${field}IntervalStart`);
                if (startElement) {
                    if (base !== '*') {
                        startElement.value = base;
                    } else {
                        startElement.value = '';
                    }
                }
            } else if (value.includes('-') && !value.includes(',')) {
                // èŒƒå›´
                const parts = value.split('-');
                let start = parts[0];
                let end = parts[1];
                
                // å¤„ç†æ˜ŸæœŸåç§°
                if (field === 'week') {
                    start = weekNamesReverse[start] || start;
                    end = weekNamesReverse[end] || end;
                }
                
                setFieldTypeProgram(field, 'range');
                const startElement = document.getElementById(`${field}RangeStart`);
                const endElement = document.getElementById(`${field}RangeEnd`);
                if (startElement && endElement) {
                    startElement.value = start;
                    endElement.value = end;
                }
            } else {
                // æŒ‡å®šå€¼ï¼ˆåˆ—è¡¨æˆ–å•ä¸ªå€¼ï¼‰
                // å¯èƒ½æ˜¯æ•°å­—ã€æ•°å­—åˆ—è¡¨æˆ–æ˜ŸæœŸåç§°
                const isWeekName = field === 'week' && weekNamesReverse[value];
                const isNumber = !isNaN(value) && value !== '*' && value !== '?';
                const isList = value.includes(',');
                
                if (isList || isNumber || isWeekName) {
                    setFieldTypeProgram(field, 'specific');
                    const values = value.split(',');
                    
                    // è½¬æ¢æ˜ŸæœŸåç§°
                    const numericValues = values.map(v => {
                        if (field === 'week' && weekNamesReverse[v]) {
                            return weekNamesReverse[v];
                        }
                        return v;
                    });
                    
                    // å‹¾é€‰å¯¹åº”çš„å¤é€‰æ¡†
                    const checkboxContainer = document.getElementById(`${field}Checkboxes`);
                    if (checkboxContainer) {
                        const checkboxItems = checkboxContainer.querySelectorAll('.checkbox-item');
                        checkboxItems.forEach(item => {
                            const checkbox = item.querySelector('input[type="checkbox"]');
                            if (numericValues.includes(checkbox.value)) {
                                checkbox.checked = true;
                                item.classList.add('checked');
                            }
                        });
                    }
                }
            }
        }

        // ç¨‹åºåŒ–è®¾ç½®å­—æ®µç±»å‹ï¼ˆä¸ä¾èµ–eventå¯¹è±¡ï¼‰
        function setFieldTypeProgram(field, type) {
            cronState[field].type = type;

            // è·å–å¯¹åº”çš„cron-fieldå…ƒç´ 
            const allFields = document.querySelectorAll('.cron-field');
            const fieldMap = {
                'second': 0,
                'minute': 1,
                'hour': 2,
                'day': 3,
                'month': 4,
                'week': 5
            };
            const fieldElement = allFields[fieldMap[field]];
            
            if (!fieldElement) return;

            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            fieldElement.querySelectorAll('.type-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // æ‰¾åˆ°å¯¹åº”ç±»å‹çš„æŒ‰é’®å¹¶æ¿€æ´»
            const typeButtons = fieldElement.querySelectorAll('.type-btn');
            typeButtons.forEach(btn => {
                const btnText = btn.textContent.trim();
                let shouldActivate = false;
                
                switch(type) {
                    case 'every':
                        if (field === 'week') {
                            shouldActivate = btnText.includes('æ¯å¤©');
                        } else {
                            shouldActivate = btnText.includes('æ¯') && !btnText.includes('éš”');
                        }
                        break;
                    case 'any':
                        shouldActivate = btnText.includes('ä¸æŒ‡å®š');
                        break;
                    case 'interval':
                        shouldActivate = btnText.includes('é—´éš”');
                        break;
                    case 'range':
                        shouldActivate = btnText.includes('èŒƒå›´');
                        break;
                    case 'specific':
                        shouldActivate = btnText.includes('æŒ‡å®š') && !btnText.includes('ä¸æŒ‡å®š');
                        break;
                    case 'workday':
                        shouldActivate = btnText.includes('å·¥ä½œæ—¥');
                        break;
                    case 'last':
                        shouldActivate = btnText.includes('æœ€å');
                        break;
                }
                
                if (shouldActivate) {
                    btn.classList.add('active');
                }
            });

            // éšè—æ‰€æœ‰é…ç½®
            fieldElement.querySelectorAll('.cron-field-config').forEach(config => {
                config.classList.remove('active');
            });

            // æ˜¾ç¤ºå¯¹åº”é…ç½®
            if (type !== 'every' && type !== 'any' && type !== 'workday') {
                const configElement = document.getElementById(`${field}-${type}`);
                if (configElement) {
                    configElement.classList.add('active');
                }
            }
        }

        // è·å–å†å²è®°å½•
        function getHistory() {
            const historyStr = localStorage.getItem('cron_history');
            return historyStr ? JSON.parse(historyStr) : [];
        }

        // åŠ è½½å†å²è®°å½•
        function loadHistory() {
            const history = getHistory();
            const historyList = document.getElementById('historyList');

            if (history.length === 0) {
                historyList.innerHTML = `
                    <div class="empty-history">
                        <div>ğŸ“­</div>
                        <p>æš‚æ— å†å²è®°å½•</p>
                    </div>
                `;
                return;
            }

            historyList.innerHTML = history.map(record => `
                <div class="history-item" onclick="loadFromHistory(${record.id}, event)">
                    <div class="history-item-header">
                        <div class="history-item-cron">${record.cron}</div>
                        <div class="history-item-actions">
                            <div class="history-item-date">${record.timestamp}</div>
                            <button class="delete-history-btn" onclick="deleteHistoryItem(${record.id}, event)" title="åˆ é™¤æ­¤è®°å½•">åˆ é™¤</button>
                        </div>
                    </div>
                    <div class="history-item-desc">${record.description}</div>
                </div>
            `).join('');
        }

        // ä»å†å²åŠ è½½
        function loadFromHistory(id, event) {
            const history = getHistory();
            const record = history.find(r => r.id === id);
            if (record) {
                parseCron(record.cron);
                
                // æ˜¾ç¤ºå†å²é¡¹åé¦ˆæ•ˆæœ
                if (event) {
                    const item = event.currentTarget || event.target.closest('.history-item');
                    if (item) {
                        const originalBg = item.style.background || '';
                        item.style.background = '#d4edda';
                        
                        setTimeout(() => {
                            item.style.background = originalBg;
                        }, 500);
                    }
                }
            }
        }

        // åˆ é™¤å†å²è®°å½•é¡¹
        function deleteHistoryItem(recordId, event) {
            event.stopPropagation();
            
            // ç›´æ¥åˆ é™¤ï¼Œä¸æ˜¾ç¤ºç¡®è®¤æç¤º
            let history = getHistory();
            history = history.filter(r => r.id !== recordId);
            localStorage.setItem('cron_history', JSON.stringify(history));
            loadHistory();
        }

        // æ¸…ç©ºå†å²è®°å½•
        function clearHistory() {
            // ç›´æ¥æ¸…ç©ºï¼Œä¸æ˜¾ç¤ºç¡®è®¤æç¤º
            localStorage.removeItem('cron_history');
            loadHistory();
        }
    </script>
</body>
</html>

